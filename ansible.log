2022-02-15 10:48:32,278 p=57218 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 10:48:32,279 p=57218 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 10:48:37,378 p=57218 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 10:48:37,380 p=57218 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 10:48:37,380 p=57218 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 10:48:37,381 p=57218 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 10:48:37,382 p=57218 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 10:48:37,391 p=57218 u=pavel n=ansible | statically imported: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/vhosts.yml
2022-02-15 10:48:37,407 p=57218 u=pavel n=ansible | Skipping callback 'default', as we already have a stdout callback.
2022-02-15 10:48:37,408 p=57218 u=pavel n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2022-02-15 10:48:37,408 p=57218 u=pavel n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2022-02-15 10:48:37,408 p=57218 u=pavel n=ansible | PLAYBOOK: playbook.yml ********************************************************************************************************************************************************************************
2022-02-15 10:48:37,408 p=57218 u=pavel n=ansible | 2 plays in playbook.yml
2022-02-15 10:48:37,410 p=57218 u=pavel n=ansible | PLAY [Prepare user] ***********************************************************************************************************************************************************************************
2022-02-15 10:48:37,418 p=57218 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 10:48:38,618 p=57218 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 10:48:38,625 p=57218 u=pavel n=ansible | META: ran handlers
2022-02-15 10:48:38,631 p=57218 u=pavel n=ansible | TASK [user : Create group] ****************************************************************************************************************************************************************************
2022-02-15 10:48:39,005 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 1001, "name": "app", "state": "present", "system": false}
2022-02-15 10:48:39,013 p=57218 u=pavel n=ansible | TASK [user : Create user] *****************************************************************************************************************************************************************************
2022-02-15 10:48:39,487 p=57218 u=pavel n=ansible | changed: [192.168.88.28] => {"append": false, "changed": true, "comment": "", "group": 1001, "home": "/home/app", "move_home": false, "name": "app", "password": "NOT_LOGGING_PASSWORD", "shell": "/bin/bash", "state": "present", "uid": 1001}
2022-02-15 10:48:39,495 p=57218 u=pavel n=ansible | TASK [user : Create directory] ************************************************************************************************************************************************************************
2022-02-15 10:48:39,904 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 1001, "group": "app", "mode": "0755", "owner": "app", "path": "/home/app/test_dir", "size": 4096, "state": "directory", "uid": 1001}
2022-02-15 10:48:39,911 p=57218 u=pavel n=ansible | TASK [user : Copy file to remote host] ****************************************************************************************************************************************************************
2022-02-15 10:48:40,812 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "checksum": "03840deb949d6cf0c0a624fa7eba87fbdbcb7783", "dest": "/home/app/test_dir/test.txt", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/home/app/test_dir/test.txt", "size": 10, "state": "file", "uid": 0}
2022-02-15 10:48:40,820 p=57218 u=pavel n=ansible | TASK [user : Install packages] ************************************************************************************************************************************************************************
2022-02-15 10:48:41,965 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 10:48:41,971 p=57218 u=pavel n=ansible | META: ran handlers
2022-02-15 10:48:41,977 p=57218 u=pavel n=ansible | META: ran handlers
2022-02-15 10:48:41,980 p=57218 u=pavel n=ansible | PLAY [Add apps] ***************************************************************************************************************************************************************************************
2022-02-15 10:48:41,994 p=57218 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 10:48:42,683 p=57218 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 10:48:42,691 p=57218 u=pavel n=ansible | META: ran handlers
2022-02-15 10:48:42,697 p=57218 u=pavel n=ansible | TASK [mysql : Ensure packages is present using apt] ***************************************************************************************************************************************************
2022-02-15 10:48:43,832 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 10:48:43,838 p=57218 u=pavel n=ansible | TASK [mysql : Ensure pymysql is present using pip] ****************************************************************************************************************************************************
2022-02-15 10:48:45,308 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "cmd": ["/usr/bin/pip3", "install", "pymysql"], "name": ["pymysql"], "requirements": null, "state": "present", "stderr": "", "stderr_lines": [], "stdout": "Requirement already satisfied: pymysql in /usr/local/lib/python3.8/dist-packages (1.0.2)\n", "stdout_lines": ["Requirement already satisfied: pymysql in /usr/local/lib/python3.8/dist-packages (1.0.2)"], "version": null, "virtualenv": null}
2022-02-15 10:48:45,316 p=57218 u=pavel n=ansible | TASK [mysql : Started mysql] **************************************************************************************************************************************************************************
2022-02-15 10:48:45,911 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "name": "mysql", "state": "started", "status": {"ActiveEnterTimestamp": "Tue 2022-02-15 09:41:04 MSK", "ActiveEnterTimestampMonotonic": "7220241", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice systemd-journald.socket basic.target -.mount network.target sysinit.target", "AllowIsolate": "no", "AllowedCPUs": "", "AllowedMemoryNodes": "", "AmbientCapabilities": "", "AssertResult": "yes", "AssertTimestamp": "Tue 2022-02-15 09:41:02 MSK", "AssertTimestampMonotonic": "5182068", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "no", "CPUAffinity": "", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanClean": "runtime", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read 0x26 0x27 0x28", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Tue 2022-02-15 09:41:02 MSK", "ConditionTimestampMonotonic": "5182068", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/mysql.service", "ControlPID": "0", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "MySQL Community Server", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveCPUs": "", "EffectiveMemoryNodes": "", "Environment": "MYSQLD_PARENT_PID=1", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "895", "ExecMainStartTimestamp": "Tue 2022-02-15 09:41:02 MSK", "ExecMainStartTimestampMonotonic": "5746144", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/sbin/mysqld ; argv[]=/usr/sbin/mysqld ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/mysqld ; argv[]=/usr/sbin/mysqld ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPre": "{ path=/usr/share/mysql/mysql-systemd-start ; argv[]=/usr/share/mysql/mysql-systemd-start pre ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPreEx": "{ path=/usr/share/mysql/mysql-systemd-start ; argv[]=/usr/share/mysql/mysql-systemd-start pre ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/mysql.service", "GID": "134", "Group": "mysql", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "0", "IOSchedulingPriority": "0", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "mysql.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Tue 2022-02-15 09:41:02 MSK", "InactiveExitTimestampMonotonic": "5184347", "InvocationID": "d6e0889fe69a494d881e49211ed1802d", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "10000", "LimitNOFILESoft": "10000", "LimitNPROC": "15295", "LimitNPROCSoft": "15295", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "15295", "LimitSIGPENDINGSoft": "15295", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "895", "MemoryAccounting": "yes", "MemoryCurrent": "420773888", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "MountFlags": "", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAMask": "", "NUMAPolicy": "n/a", "Names": "mysql.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PIDFile": "/run/mysqld/mysqld.pid", "Perpetual": "no", "PrivateDevices": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target -.mount", "RequiresMountsFor": "/run/mysqld", "Restart": "on-failure", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectory": "mysqld", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardInputData": "", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Tue 2022-02-15 09:41:04 MSK", "StateChangeTimestampMonotonic": "7220241", "StateDirectoryMode": "0755", "StatusErrno": "0", "StatusText": "Server is operational", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "37", "TasksMax": "4588", "TimeoutAbortUSec": "infinity", "TimeoutCleanUSec": "infinity", "TimeoutStartUSec": "infinity", "TimeoutStopUSec": "infinity", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "128", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "mysql", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2022-02-15 10:48:45,925 p=57218 u=pavel n=ansible | TASK [mysql : Set the root password] ******************************************************************************************************************************************************************
2022-02-15 10:48:45,992 p=57846 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 10:48:46,374 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 10:48:46,381 p=57218 u=pavel n=ansible | TASK [mysql : Remove all anonymous user accounts] *****************************************************************************************************************************************************
2022-02-15 10:48:46,445 p=57884 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 10:48:46,708 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 10:48:46,716 p=57218 u=pavel n=ansible | TASK [mysql : Remove the MySQL test database] *********************************************************************************************************************************************************
2022-02-15 10:48:46,779 p=57916 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 10:48:47,157 p=57218 u=pavel n=ansible | [WARNING]: Module did not set no_log for unsafe_login_password

2022-02-15 10:48:47,157 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "db": "test", "db_list": ["test"], "executed_commands": []}
2022-02-15 10:48:47,164 p=57218 u=pavel n=ansible | TASK [mysql : Creates database] ***********************************************************************************************************************************************************************
2022-02-15 10:48:47,228 p=57954 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 10:48:47,477 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "db": "db", "db_list": ["db"], "executed_commands": []}
2022-02-15 10:48:47,485 p=57218 u=pavel n=ansible | TASK [mysql : Create MySQL admin user for database] ***************************************************************************************************************************************************
2022-02-15 10:48:47,549 p=57986 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 10:48:47,826 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 10:48:47,834 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : Include OS-specific variables.] *********************************************************************************************************************************************
2022-02-15 10:48:47,873 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"ansible_facts": {"__nginx_user": "www-data", "nginx_conf_file_path": "/etc/nginx/nginx.conf", "nginx_conf_path": "/etc/nginx/conf.d", "nginx_default_vhost_path": "/etc/nginx/sites-enabled/default", "nginx_mime_file_path": "/etc/nginx/mime.types", "nginx_pidfile": "/run/nginx.pid", "nginx_vhost_path": "/etc/nginx/sites-enabled", "root_group": "root"}, "ansible_included_var_files": ["/home/pavel/ansible-cm/roles/geerlingguy.nginx/vars/Debian.yml"], "changed": false}
2022-02-15 10:48:47,883 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : Define nginx_user.] *********************************************************************************************************************************************************
2022-02-15 10:48:47,923 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"ansible_facts": {"nginx_user": "www-data"}, "changed": false}
2022-02-15 10:48:47,932 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 10:48:47,966 p=57218 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 10:48:47,976 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 10:48:48,016 p=57218 u=pavel n=ansible | included: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/setup-Ubuntu.yml for 192.168.88.28
2022-02-15 10:48:48,026 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure dirmngr is installed (gnupg dependency).] ****************************************************************************************************************************
2022-02-15 10:48:49,010 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 10:48:49,018 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : Add PPA for Nginx (if configured).] *****************************************************************************************************************************************
2022-02-15 10:48:49,050 p=57218 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 10:48:49,058 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx will reinstall if the PPA was just added.] *********************************************************************************************************************
2022-02-15 10:48:49,092 p=57218 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 10:48:49,101 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 10:48:49,146 p=57218 u=pavel n=ansible | included: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/setup-Debian.yml for 192.168.88.28
2022-02-15 10:48:49,157 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : Update apt cache.] **********************************************************************************************************************************************************
2022-02-15 10:48:49,887 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 10:48:49,894 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx is installed.] *************************************************************************************************************************************************
2022-02-15 10:48:50,922 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 10:48:50,929 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 10:48:50,960 p=57218 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 10:48:50,968 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 10:48:51,000 p=57218 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 10:48:51,009 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 10:48:51,040 p=57218 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 10:48:51,048 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : Remove default nginx vhost config file (if configured).] ********************************************************************************************************************
2022-02-15 10:48:51,081 p=57218 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 10:48:51,089 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx_vhost_path exists.] ********************************************************************************************************************************************
2022-02-15 10:48:51,405 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/etc/nginx/sites-enabled", "size": 4096, "state": "directory", "uid": 0}
2022-02-15 10:48:51,412 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : Add managed vhost config files.] ********************************************************************************************************************************************
2022-02-15 10:48:51,449 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : Remove managed vhost config files.] *****************************************************************************************************************************************
2022-02-15 10:48:51,488 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : Remove legacy vhosts.conf file.] ********************************************************************************************************************************************
2022-02-15 10:48:51,773 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "path": "/etc/nginx/sites-enabled/vhosts.conf", "state": "absent"}
2022-02-15 10:48:51,781 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : Copy nginx configuration in place.] *****************************************************************************************************************************************
2022-02-15 10:48:52,326 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "checksum": "0b0918e4dfb9031651b7262482e3060fc7667ba5", "dest": "/etc/nginx/nginx.conf", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/nginx/nginx.conf", "size": 883, "state": "file", "uid": 0}
2022-02-15 10:48:52,333 p=57218 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx service is running as configured.] *****************************************************************************************************************************
2022-02-15 10:48:52,760 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "enabled": true, "name": "nginx", "state": "started", "status": {"ActiveEnterTimestamp": "Tue 2022-02-15 10:23:05 MSK", "ActiveEnterTimestampMonotonic": "2530235319", "ActiveExitTimestamp": "Tue 2022-02-15 09:50:21 MSK", "ActiveExitTimestampMonotonic": "566958399", "ActiveState": "active", "After": "system.slice systemd-journald.socket basic.target network.target sysinit.target", "AllowIsolate": "no", "AllowedCPUs": "", "AllowedMemoryNodes": "", "AmbientCapabilities": "", "AssertResult": "yes", "AssertTimestamp": "Tue 2022-02-15 10:23:05 MSK", "AssertTimestampMonotonic": "2530221105", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "no", "CPUAffinity": "", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read 0x26 0x27 0x28", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Tue 2022-02-15 10:23:05 MSK", "ConditionTimestampMonotonic": "2530221105", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/nginx.service", "ControlPID": "0", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "A high performance web server and a reverse proxy server", "DevicePolicy": "auto", "Documentation": "man:nginx(8)", "DynamicUser": "no", "EffectiveCPUs": "", "EffectiveMemoryNodes": "", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "28442", "ExecMainStartTimestamp": "Tue 2022-02-15 10:23:05 MSK", "ExecMainStartTimestampMonotonic": "2530235301", "ExecMainStatus": "0", "ExecReload": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; ignore_errors=no ; start_time=[Tue 2022-02-15 10:24:13 MSK] ; stop_time=[Tue 2022-02-15 10:24:13 MSK] ; pid=34838 ; code=exited ; status=0 }", "ExecReloadEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; flags= ; start_time=[Tue 2022-02-15 10:24:13 MSK] ; stop_time=[Tue 2022-02-15 10:24:13 MSK] ; pid=34838 ; code=exited ; status=0 }", "ExecStart": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPre": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPreEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStop": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; ignore_errors=yes ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStopEx": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; flags=ignore-failure ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/nginx.service", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "0", "IOSchedulingPriority": "0", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "nginx.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Tue 2022-02-15 10:21:12 MSK", "InactiveEnterTimestampMonotonic": "2417569318", "InactiveExitTimestamp": "Tue 2022-02-15 10:23:05 MSK", "InactiveExitTimestampMonotonic": "2530223057", "InvocationID": "b65f8dd35c4a4016876e6d5436f981ce", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "15295", "LimitNPROCSoft": "15295", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "15295", "LimitSIGPENDINGSoft": "15295", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "28442", "MemoryAccounting": "yes", "MemoryCurrent": "2879488", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "MountFlags": "", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAMask": "", "NUMAPolicy": "n/a", "Names": "nginx.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PIDFile": "/run/nginx.pid", "Perpetual": "no", "PrivateDevices": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "no", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardInputData": "", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Tue 2022-02-15 10:24:13 MSK", "StateChangeTimestampMonotonic": "2598661082", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "3", "TasksMax": "4588", "TimeoutAbortUSec": "5s", "TimeoutCleanUSec": "infinity", "TimeoutStartUSec": "1min 30s", "TimeoutStopUSec": "5s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "forking", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2022-02-15 10:48:52,767 p=57218 u=pavel n=ansible | TASK [php : Ensure PHP server and plugins is present using apt] ***************************************************************************************************************************************
2022-02-15 10:48:53,769 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 10:48:53,777 p=57218 u=pavel n=ansible | TASK [wordpress : Creates directory] ******************************************************************************************************************************************************************
2022-02-15 10:48:54,030 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 33, "group": "www-data", "mode": "0755", "owner": "www-data", "path": "/var/www/http_host", "size": 4096, "state": "directory", "uid": 33}
2022-02-15 10:48:54,038 p=57218 u=pavel n=ansible | TASK [wordpress : Download and unpack latest WordPress] ***********************************************************************************************************************************************
2022-02-15 10:48:54,142 p=57218 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "msg": "skipped, since /var/www/http_host/wordpress exists"}
2022-02-15 10:48:54,151 p=57218 u=pavel n=ansible | TASK [wordpress : Set ownership] **********************************************************************************************************************************************************************
2022-02-15 10:48:54,582 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 33, "group": "www-data", "mode": "0755", "owner": "www-data", "path": "/var/www/http_host", "size": 4096, "state": "directory", "uid": 33}
2022-02-15 10:48:54,589 p=57218 u=pavel n=ansible | TASK [wordpress : Set permissions for directories] ****************************************************************************************************************************************************
2022-02-15 10:48:55,208 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "cmd": "/usr/bin/find /var/www/http_host/wordpress/ -type d -exec chmod 750 {} \\;", "delta": "0:00:00.269802", "end": "2022-02-15 10:48:55.173866", "msg": "", "rc": 0, "start": "2022-02-15 10:48:54.904064", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-02-15 10:48:55,216 p=57218 u=pavel n=ansible | TASK [wordpress : Set permissions for files] **********************************************************************************************************************************************************
2022-02-15 10:48:57,734 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "cmd": "/usr/bin/find /var/www/http_host/wordpress/ -type f -exec chmod 640 {} \\;", "delta": "0:00:02.220253", "end": "2022-02-15 10:48:57.698817", "msg": "", "rc": 0, "start": "2022-02-15 10:48:55.478564", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-02-15 10:48:57,741 p=57218 u=pavel n=ansible | TASK [wordpress : Set up wp-config] *******************************************************************************************************************************************************************
2022-02-15 10:48:58,387 p=57218 u=pavel n=ansible | changed: [192.168.88.28] => {"changed": true, "checksum": "66799d0fc041e3108cd8f7b1977b6411bb36ed4b", "dest": "/var/www/http_host/wordpress/wp-config.php", "gid": 33, "group": "www-data", "md5sum": "990872363223cabb85ef1ccbdbd7f0cb", "mode": "0640", "owner": "www-data", "size": 3131, "src": "/home/pavel/.ansible/tmp/ansible-tmp-1644911337.7861392-61629-128919272981763/source", "state": "file", "uid": 33}
2022-02-15 10:48:58,394 p=57218 u=pavel n=ansible | TASK [wordpress : Add site to sites folder in Nginx] **************************************************************************************************************************************************
2022-02-15 10:48:58,887 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "checksum": "673bd3011f8837e4c1aa3c6dd0052d7db1889327", "dest": "/etc/nginx/sites-available/wordpress", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/nginx/sites-available/wordpress", "size": 968, "state": "file", "uid": 0}
2022-02-15 10:48:58,894 p=57218 u=pavel n=ansible | TASK [wordpress : Activate activate site] *************************************************************************************************************************************************************
2022-02-15 10:48:59,191 p=57218 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "dest": "/etc/nginx/sites-enabled/wordpress", "gid": 0, "group": "root", "mode": "0777", "owner": "root", "size": 36, "src": "/etc/nginx/sites-available/wordpress", "state": "link", "uid": 0}
2022-02-15 10:48:59,199 p=57218 u=pavel n=ansible | META: ran handlers
2022-02-15 10:48:59,205 p=57218 u=pavel n=ansible | META: ran handlers
2022-02-15 10:48:59,206 p=57218 u=pavel n=ansible | PLAY RECAP ********************************************************************************************************************************************************************************************
2022-02-15 10:48:59,207 p=57218 u=pavel n=ansible | 192.168.88.28              : ok=34   changed=2    unreachable=0    failed=0    skipped=10   rescued=0    ignored=0   
2022-02-15 11:07:53,347 p=68597 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 11:07:53,347 p=68597 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 11:07:58,322 p=68597 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:07:58,324 p=68597 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:07:58,325 p=68597 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:07:58,326 p=68597 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:07:58,327 p=68597 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:07:58,336 p=68597 u=pavel n=ansible | statically imported: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/vhosts.yml
2022-02-15 11:07:58,354 p=68597 u=pavel n=ansible | Skipping callback 'default', as we already have a stdout callback.
2022-02-15 11:07:58,355 p=68597 u=pavel n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2022-02-15 11:07:58,355 p=68597 u=pavel n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2022-02-15 11:07:58,355 p=68597 u=pavel n=ansible | PLAYBOOK: playbook.yml **********************************************************
2022-02-15 11:07:58,355 p=68597 u=pavel n=ansible | 2 plays in playbook.yml
2022-02-15 11:07:58,358 p=68597 u=pavel n=ansible | PLAY [Prepare user] *************************************************************
2022-02-15 11:07:58,367 p=68597 u=pavel n=ansible | TASK [Gathering Facts] **********************************************************
2022-02-15 11:08:00,525 p=68597 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 11:08:00,535 p=68597 u=pavel n=ansible | META: ran handlers
2022-02-15 11:08:00,542 p=68597 u=pavel n=ansible | TASK [user : Create group] ******************************************************
2022-02-15 11:08:00,929 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 1001, "name": "app", "state": "present", "system": false}
2022-02-15 11:08:00,937 p=68597 u=pavel n=ansible | TASK [user : Create user] *******************************************************
2022-02-15 11:08:01,448 p=68597 u=pavel n=ansible | changed: [192.168.88.28] => {"append": false, "changed": true, "comment": "", "group": 1001, "home": "/home/app", "move_home": false, "name": "app", "password": "NOT_LOGGING_PASSWORD", "shell": "/bin/bash", "state": "present", "uid": 1001}
2022-02-15 11:08:01,456 p=68597 u=pavel n=ansible | TASK [user : Create directory] **************************************************
2022-02-15 11:08:01,864 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 1001, "group": "app", "mode": "0755", "owner": "app", "path": "/home/app/test_dir", "size": 4096, "state": "directory", "uid": 1001}
2022-02-15 11:08:01,873 p=68597 u=pavel n=ansible | TASK [user : Copy file to remote host] ******************************************
2022-02-15 11:08:02,816 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "checksum": "03840deb949d6cf0c0a624fa7eba87fbdbcb7783", "dest": "/home/app/test_dir/test.txt", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/home/app/test_dir/test.txt", "size": 10, "state": "file", "uid": 0}
2022-02-15 11:08:02,823 p=68597 u=pavel n=ansible | TASK [user : Install packages] **************************************************
2022-02-15 11:08:04,008 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:08:04,016 p=68597 u=pavel n=ansible | META: ran handlers
2022-02-15 11:08:04,022 p=68597 u=pavel n=ansible | META: ran handlers
2022-02-15 11:08:04,028 p=68597 u=pavel n=ansible | PLAY [Add apps] *****************************************************************
2022-02-15 11:08:04,044 p=68597 u=pavel n=ansible | TASK [Gathering Facts] **********************************************************
2022-02-15 11:08:04,746 p=68597 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 11:08:04,755 p=68597 u=pavel n=ansible | META: ran handlers
2022-02-15 11:08:04,762 p=68597 u=pavel n=ansible | TASK [mysql : Ensure packages is present using apt] *****************************
2022-02-15 11:08:05,937 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:08:05,945 p=68597 u=pavel n=ansible | TASK [mysql : Ensure pymysql is present using pip] ******************************
2022-02-15 11:08:07,554 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "cmd": ["/usr/bin/pip3", "install", "pymysql"], "name": ["pymysql"], "requirements": null, "state": "present", "stderr": "", "stderr_lines": [], "stdout": "Requirement already satisfied: pymysql in /usr/local/lib/python3.8/dist-packages (1.0.2)\n", "stdout_lines": ["Requirement already satisfied: pymysql in /usr/local/lib/python3.8/dist-packages (1.0.2)"], "version": null, "virtualenv": null}
2022-02-15 11:08:07,561 p=68597 u=pavel n=ansible | TASK [mysql : Started mysql] ****************************************************
2022-02-15 11:08:08,242 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "name": "mysql", "state": "started", "status": {"ActiveEnterTimestamp": "Tue 2022-02-15 09:41:04 MSK", "ActiveEnterTimestampMonotonic": "7220241", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice systemd-journald.socket basic.target -.mount network.target sysinit.target", "AllowIsolate": "no", "AllowedCPUs": "", "AllowedMemoryNodes": "", "AmbientCapabilities": "", "AssertResult": "yes", "AssertTimestamp": "Tue 2022-02-15 09:41:02 MSK", "AssertTimestampMonotonic": "5182068", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "no", "CPUAffinity": "", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanClean": "runtime", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read 0x26 0x27 0x28", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Tue 2022-02-15 09:41:02 MSK", "ConditionTimestampMonotonic": "5182068", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/mysql.service", "ControlPID": "0", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "MySQL Community Server", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveCPUs": "", "EffectiveMemoryNodes": "", "Environment": "MYSQLD_PARENT_PID=1", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "895", "ExecMainStartTimestamp": "Tue 2022-02-15 09:41:02 MSK", "ExecMainStartTimestampMonotonic": "5746144", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/sbin/mysqld ; argv[]=/usr/sbin/mysqld ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/mysqld ; argv[]=/usr/sbin/mysqld ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPre": "{ path=/usr/share/mysql/mysql-systemd-start ; argv[]=/usr/share/mysql/mysql-systemd-start pre ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPreEx": "{ path=/usr/share/mysql/mysql-systemd-start ; argv[]=/usr/share/mysql/mysql-systemd-start pre ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/mysql.service", "GID": "134", "Group": "mysql", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "0", "IOSchedulingPriority": "0", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "mysql.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Tue 2022-02-15 09:41:02 MSK", "InactiveExitTimestampMonotonic": "5184347", "InvocationID": "d6e0889fe69a494d881e49211ed1802d", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "10000", "LimitNOFILESoft": "10000", "LimitNPROC": "15295", "LimitNPROCSoft": "15295", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "15295", "LimitSIGPENDINGSoft": "15295", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "895", "MemoryAccounting": "yes", "MemoryCurrent": "420835328", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "MountFlags": "", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAMask": "", "NUMAPolicy": "n/a", "Names": "mysql.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PIDFile": "/run/mysqld/mysqld.pid", "Perpetual": "no", "PrivateDevices": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target -.mount", "RequiresMountsFor": "/run/mysqld", "Restart": "on-failure", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectory": "mysqld", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardInputData": "", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Tue 2022-02-15 09:41:04 MSK", "StateChangeTimestampMonotonic": "7220241", "StateDirectoryMode": "0755", "StatusErrno": "0", "StatusText": "Server is operational", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "37", "TasksMax": "4588", "TimeoutAbortUSec": "infinity", "TimeoutCleanUSec": "infinity", "TimeoutStartUSec": "infinity", "TimeoutStopUSec": "infinity", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "128", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "mysql", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2022-02-15 11:08:08,250 p=68597 u=pavel n=ansible | TASK [mysql : Set the root password] ********************************************
2022-02-15 11:08:08,314 p=69212 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:08:08,699 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 11:08:08,707 p=68597 u=pavel n=ansible | TASK [mysql : Remove all anonymous user accounts] *******************************
2022-02-15 11:08:08,790 p=69244 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:08:09,038 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 11:08:09,045 p=68597 u=pavel n=ansible | TASK [mysql : Remove the MySQL test database] ***********************************
2022-02-15 11:08:09,110 p=69276 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:08:09,502 p=68597 u=pavel n=ansible | [WARNING]: Module did not set no_log for unsafe_login_password

2022-02-15 11:08:09,503 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "db": "test", "db_list": ["test"], "executed_commands": []}
2022-02-15 11:08:09,510 p=68597 u=pavel n=ansible | TASK [mysql : Creates database] *************************************************
2022-02-15 11:08:09,573 p=69314 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:08:09,832 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "db": "db", "db_list": ["db"], "executed_commands": []}
2022-02-15 11:08:09,840 p=68597 u=pavel n=ansible | TASK [mysql : Create MySQL admin user for database] *****************************
2022-02-15 11:08:09,904 p=69346 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:08:10,181 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 11:08:10,191 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : Include OS-specific variables.] ***********************
2022-02-15 11:08:10,227 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"ansible_facts": {"__nginx_user": "www-data", "nginx_conf_file_path": "/etc/nginx/nginx.conf", "nginx_conf_path": "/etc/nginx/conf.d", "nginx_default_vhost_path": "/etc/nginx/sites-enabled/default", "nginx_mime_file_path": "/etc/nginx/mime.types", "nginx_pidfile": "/run/nginx.pid", "nginx_vhost_path": "/etc/nginx/sites-enabled", "root_group": "root"}, "ansible_included_var_files": ["/home/pavel/ansible-cm/roles/geerlingguy.nginx/vars/Debian.yml"], "changed": false}
2022-02-15 11:08:10,234 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : Define nginx_user.] ***********************************
2022-02-15 11:08:10,271 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"ansible_facts": {"nginx_user": "www-data"}, "changed": false}
2022-02-15 11:08:10,278 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] ****************************************
2022-02-15 11:08:10,313 p=68597 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:08:10,320 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] ****************************************
2022-02-15 11:08:10,363 p=68597 u=pavel n=ansible | included: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/setup-Ubuntu.yml for 192.168.88.28
2022-02-15 11:08:10,372 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure dirmngr is installed (gnupg dependency).] ******
2022-02-15 11:08:11,432 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:08:11,441 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : Add PPA for Nginx (if configured).] *******************
2022-02-15 11:08:11,474 p=68597 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:08:11,482 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx will reinstall if the PPA was just added.] ***
2022-02-15 11:08:11,514 p=68597 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:08:11,522 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] ****************************************
2022-02-15 11:08:11,567 p=68597 u=pavel n=ansible | included: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/setup-Debian.yml for 192.168.88.28
2022-02-15 11:08:11,578 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : Update apt cache.] ************************************
2022-02-15 11:08:12,329 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:08:12,337 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx is installed.] ***************************
2022-02-15 11:08:13,389 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:08:13,396 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] ****************************************
2022-02-15 11:08:13,428 p=68597 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:08:13,436 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] ****************************************
2022-02-15 11:08:13,470 p=68597 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:08:13,477 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] ****************************************
2022-02-15 11:08:13,510 p=68597 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:08:13,518 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : Remove default nginx vhost config file (if configured).] ***
2022-02-15 11:08:13,581 p=68597 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:08:13,589 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx_vhost_path exists.] **********************
2022-02-15 11:08:13,879 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/etc/nginx/sites-enabled", "size": 4096, "state": "directory", "uid": 0}
2022-02-15 11:08:13,888 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : Add managed vhost config files.] **********************
2022-02-15 11:08:13,925 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : Remove managed vhost config files.] *******************
2022-02-15 11:08:13,965 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : Remove legacy vhosts.conf file.] **********************
2022-02-15 11:08:14,263 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "path": "/etc/nginx/sites-enabled/vhosts.conf", "state": "absent"}
2022-02-15 11:08:14,268 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : Copy nginx configuration in place.] *******************
2022-02-15 11:08:14,786 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "checksum": "0b0918e4dfb9031651b7262482e3060fc7667ba5", "dest": "/etc/nginx/nginx.conf", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/nginx/nginx.conf", "size": 883, "state": "file", "uid": 0}
2022-02-15 11:08:14,794 p=68597 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx service is running as configured.] *******
2022-02-15 11:08:15,233 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "enabled": true, "name": "nginx", "state": "started", "status": {"ActiveEnterTimestamp": "Tue 2022-02-15 10:23:05 MSK", "ActiveEnterTimestampMonotonic": "2530235319", "ActiveExitTimestamp": "Tue 2022-02-15 09:50:21 MSK", "ActiveExitTimestampMonotonic": "566958399", "ActiveState": "active", "After": "system.slice systemd-journald.socket basic.target network.target sysinit.target", "AllowIsolate": "no", "AllowedCPUs": "", "AllowedMemoryNodes": "", "AmbientCapabilities": "", "AssertResult": "yes", "AssertTimestamp": "Tue 2022-02-15 10:23:05 MSK", "AssertTimestampMonotonic": "2530221105", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "no", "CPUAffinity": "", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read 0x26 0x27 0x28", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Tue 2022-02-15 10:23:05 MSK", "ConditionTimestampMonotonic": "2530221105", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/nginx.service", "ControlPID": "0", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "A high performance web server and a reverse proxy server", "DevicePolicy": "auto", "Documentation": "man:nginx(8)", "DynamicUser": "no", "EffectiveCPUs": "", "EffectiveMemoryNodes": "", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "28442", "ExecMainStartTimestamp": "Tue 2022-02-15 10:23:05 MSK", "ExecMainStartTimestampMonotonic": "2530235301", "ExecMainStatus": "0", "ExecReload": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; ignore_errors=no ; start_time=[Tue 2022-02-15 10:24:13 MSK] ; stop_time=[Tue 2022-02-15 10:24:13 MSK] ; pid=34838 ; code=exited ; status=0 }", "ExecReloadEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; flags= ; start_time=[Tue 2022-02-15 10:24:13 MSK] ; stop_time=[Tue 2022-02-15 10:24:13 MSK] ; pid=34838 ; code=exited ; status=0 }", "ExecStart": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPre": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPreEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStop": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; ignore_errors=yes ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStopEx": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; flags=ignore-failure ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/nginx.service", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "0", "IOSchedulingPriority": "0", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "nginx.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Tue 2022-02-15 10:21:12 MSK", "InactiveEnterTimestampMonotonic": "2417569318", "InactiveExitTimestamp": "Tue 2022-02-15 10:23:05 MSK", "InactiveExitTimestampMonotonic": "2530223057", "InvocationID": "b65f8dd35c4a4016876e6d5436f981ce", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "15295", "LimitNPROCSoft": "15295", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "15295", "LimitSIGPENDINGSoft": "15295", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "28442", "MemoryAccounting": "yes", "MemoryCurrent": "2875392", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "MountFlags": "", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAMask": "", "NUMAPolicy": "n/a", "Names": "nginx.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PIDFile": "/run/nginx.pid", "Perpetual": "no", "PrivateDevices": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "no", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardInputData": "", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Tue 2022-02-15 10:24:13 MSK", "StateChangeTimestampMonotonic": "2598661082", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "3", "TasksMax": "4588", "TimeoutAbortUSec": "5s", "TimeoutCleanUSec": "infinity", "TimeoutStartUSec": "1min 30s", "TimeoutStopUSec": "5s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "forking", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2022-02-15 11:08:15,241 p=68597 u=pavel n=ansible | TASK [php : Ensure PHP server and plugins is present using apt] *****************
2022-02-15 11:08:16,293 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:08:16,300 p=68597 u=pavel n=ansible | TASK [wordpress : Creates directory] ********************************************
2022-02-15 11:08:16,565 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 33, "group": "www-data", "mode": "0755", "owner": "www-data", "path": "/var/www/http_host", "size": 4096, "state": "directory", "uid": 33}
2022-02-15 11:08:16,572 p=68597 u=pavel n=ansible | TASK [wordpress : Download and unpack latest WordPress] *************************
2022-02-15 11:08:16,676 p=68597 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "msg": "skipped, since /var/www/http_host/wordpress exists"}
2022-02-15 11:08:16,683 p=68597 u=pavel n=ansible | TASK [wordpress : Set ownership] ************************************************
2022-02-15 11:08:17,109 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 33, "group": "www-data", "mode": "0755", "owner": "www-data", "path": "/var/www/http_host", "size": 4096, "state": "directory", "uid": 33}
2022-02-15 11:08:17,117 p=68597 u=pavel n=ansible | TASK [wordpress : Set permissions for directories] ******************************
2022-02-15 11:08:17,782 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "cmd": "/usr/bin/find /var/www/http_host/wordpress/ -type d -exec chmod 750 {} \\;", "delta": "0:00:00.280311", "end": "2022-02-15 11:08:17.742966", "msg": "", "rc": 0, "start": "2022-02-15 11:08:17.462655", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-02-15 11:08:17,789 p=68597 u=pavel n=ansible | TASK [wordpress : Set permissions for files] ************************************
2022-02-15 11:08:20,333 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "cmd": "/usr/bin/find /var/www/http_host/wordpress/ -type f -exec chmod 640 {} \\;", "delta": "0:00:02.268984", "end": "2022-02-15 11:08:20.297209", "msg": "", "rc": 0, "start": "2022-02-15 11:08:18.028225", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-02-15 11:08:20,341 p=68597 u=pavel n=ansible | TASK [wordpress : Set up wp-config] *********************************************
2022-02-15 11:08:21,000 p=68597 u=pavel n=ansible | changed: [192.168.88.28] => {"changed": true, "checksum": "8c4ba2db9645e1164d8c1043fca03a0f3811121e", "dest": "/var/www/http_host/wordpress/wp-config.php", "gid": 33, "group": "www-data", "md5sum": "7ac0bf847d7612d69be18d5cce49976e", "mode": "0640", "owner": "www-data", "size": 3131, "src": "/home/pavel/.ansible/tmp/ansible-tmp-1644912500.3884237-72995-69035217838097/source", "state": "file", "uid": 33}
2022-02-15 11:08:21,008 p=68597 u=pavel n=ansible | TASK [wordpress : Add site to sites folder in Nginx] ****************************
2022-02-15 11:08:21,518 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "checksum": "673bd3011f8837e4c1aa3c6dd0052d7db1889327", "dest": "/etc/nginx/sites-available/wordpress", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/nginx/sites-available/wordpress", "size": 968, "state": "file", "uid": 0}
2022-02-15 11:08:21,526 p=68597 u=pavel n=ansible | TASK [wordpress : Activate activate site] ***************************************
2022-02-15 11:08:21,819 p=68597 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "dest": "/etc/nginx/sites-enabled/wordpress", "gid": 0, "group": "root", "mode": "0777", "owner": "root", "size": 36, "src": "/etc/nginx/sites-available/wordpress", "state": "link", "uid": 0}
2022-02-15 11:08:21,827 p=68597 u=pavel n=ansible | META: ran handlers
2022-02-15 11:08:21,835 p=68597 u=pavel n=ansible | META: ran handlers
2022-02-15 11:08:21,837 p=68597 u=pavel n=ansible | PLAY RECAP **********************************************************************
2022-02-15 11:08:21,837 p=68597 u=pavel n=ansible | 192.168.88.28              : ok=34   changed=2    unreachable=0    failed=0    skipped=10   rescued=0    ignored=0   
2022-02-15 11:12:17,369 p=74608 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 11:12:17,370 p=74608 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 11:12:22,093 p=74608 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:12:22,095 p=74608 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:12:22,096 p=74608 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:12:22,097 p=74608 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:12:22,097 p=74608 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:12:22,106 p=74608 u=pavel n=ansible | statically imported: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/vhosts.yml
2022-02-15 11:12:22,120 p=74608 u=pavel n=ansible | ERROR! 'uri' is not a valid attribute for a Play

The error appears to be in '/home/pavel/ansible-cm/playbook.yml': line 19, column 3, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


- name: Check nginx is responsing
  ^ here

2022-02-15 11:14:59,551 p=75589 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 11:14:59,552 p=75589 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 11:15:03,984 p=75589 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:15:03,986 p=75589 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:15:03,987 p=75589 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:15:03,988 p=75589 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:15:03,989 p=75589 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:15:03,998 p=75589 u=pavel n=ansible | statically imported: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/vhosts.yml
2022-02-15 11:15:04,011 p=75589 u=pavel n=ansible | ERROR! 'uri' is not a valid attribute for a Play

The error appears to be in '/home/pavel/ansible-cm/playbook.yml': line 19, column 3, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


- name: Check url
  ^ here

2022-02-15 11:16:48,699 p=76255 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 11:16:48,699 p=76255 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 11:16:53,389 p=76255 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:16:53,391 p=76255 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:16:53,392 p=76255 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:16:53,393 p=76255 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:16:53,394 p=76255 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:16:53,405 p=76255 u=pavel n=ansible | statically imported: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/vhosts.yml
2022-02-15 11:16:53,418 p=76255 u=pavel n=ansible | ERROR! 'uri' is not a valid attribute for a Play

The error appears to be in '/home/pavel/ansible-cm/playbook.yml': line 20, column 3, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


- name: Check URL
  ^ here

2022-02-15 11:18:18,943 p=76803 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 11:18:18,943 p=76803 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 11:18:23,608 p=76803 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:18:23,610 p=76803 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:18:23,610 p=76803 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:18:23,611 p=76803 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:18:23,612 p=76803 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:18:23,622 p=76803 u=pavel n=ansible | statically imported: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/vhosts.yml
2022-02-15 11:18:23,636 p=76803 u=pavel n=ansible | ERROR! 'uri' is not a valid attribute for a Play

The error appears to be in '/home/pavel/ansible-cm/playbook.yml': line 20, column 3, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


- name: Check URL
  ^ here

2022-02-15 11:19:14,177 p=77139 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 11:19:14,178 p=77139 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 11:19:14,845 p=77139 u=pavel n=ansible |  [ERROR]: User interrupted execution

2022-02-15 11:20:48,373 p=77752 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 11:20:48,373 p=77752 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 11:20:54,270 p=77752 u=pavel n=ansible |  [ERROR]: User interrupted execution

2022-02-15 11:20:55,379 p=77797 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 11:20:55,380 p=77797 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 11:20:59,561 p=77797 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:20:59,563 p=77797 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:20:59,564 p=77797 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:20:59,565 p=77797 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:20:59,565 p=77797 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:20:59,574 p=77797 u=pavel n=ansible | statically imported: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/vhosts.yml
2022-02-15 11:20:59,593 p=77797 u=pavel n=ansible | Skipping callback 'default', as we already have a stdout callback.
2022-02-15 11:20:59,594 p=77797 u=pavel n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2022-02-15 11:20:59,594 p=77797 u=pavel n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2022-02-15 11:20:59,594 p=77797 u=pavel n=ansible | PLAYBOOK: playbook.yml **********************************************************
2022-02-15 11:20:59,594 p=77797 u=pavel n=ansible | 2 plays in playbook.yml
2022-02-15 11:20:59,596 p=77797 u=pavel n=ansible | PLAY [Prepare user] *************************************************************
2022-02-15 11:20:59,605 p=77797 u=pavel n=ansible | TASK [Gathering Facts] **********************************************************
2022-02-15 11:21:00,792 p=77797 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 11:21:00,799 p=77797 u=pavel n=ansible | META: ran handlers
2022-02-15 11:21:00,807 p=77797 u=pavel n=ansible | TASK [user : Create group] ******************************************************
2022-02-15 11:21:01,171 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 1001, "name": "app", "state": "present", "system": false}
2022-02-15 11:21:01,177 p=77797 u=pavel n=ansible | TASK [user : Create user] *******************************************************
2022-02-15 11:21:01,635 p=77797 u=pavel n=ansible | changed: [192.168.88.28] => {"append": false, "changed": true, "comment": "", "group": 1001, "home": "/home/app", "move_home": false, "name": "app", "password": "NOT_LOGGING_PASSWORD", "shell": "/bin/bash", "state": "present", "uid": 1001}
2022-02-15 11:21:01,641 p=77797 u=pavel n=ansible | TASK [user : Create directory] **************************************************
2022-02-15 11:21:02,054 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 1001, "group": "app", "mode": "0755", "owner": "app", "path": "/home/app/test_dir", "size": 4096, "state": "directory", "uid": 1001}
2022-02-15 11:21:02,061 p=77797 u=pavel n=ansible | TASK [user : Copy file to remote host] ******************************************
2022-02-15 11:21:02,966 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "checksum": "03840deb949d6cf0c0a624fa7eba87fbdbcb7783", "dest": "/home/app/test_dir/test.txt", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/home/app/test_dir/test.txt", "size": 10, "state": "file", "uid": 0}
2022-02-15 11:21:02,973 p=77797 u=pavel n=ansible | TASK [user : Install packages] **************************************************
2022-02-15 11:21:04,115 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:21:04,123 p=77797 u=pavel n=ansible | META: ran handlers
2022-02-15 11:21:04,131 p=77797 u=pavel n=ansible | META: ran handlers
2022-02-15 11:21:04,136 p=77797 u=pavel n=ansible | PLAY [Add apps] *****************************************************************
2022-02-15 11:21:04,154 p=77797 u=pavel n=ansible | TASK [Gathering Facts] **********************************************************
2022-02-15 11:21:04,831 p=77797 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 11:21:04,839 p=77797 u=pavel n=ansible | META: ran handlers
2022-02-15 11:21:04,850 p=77797 u=pavel n=ansible | TASK [mysql : Ensure packages is present using apt] *****************************
2022-02-15 11:21:05,979 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:21:05,986 p=77797 u=pavel n=ansible | TASK [mysql : Ensure pymysql is present using pip] ******************************
2022-02-15 11:21:07,452 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "cmd": ["/usr/bin/pip3", "install", "pymysql"], "name": ["pymysql"], "requirements": null, "state": "present", "stderr": "", "stderr_lines": [], "stdout": "Requirement already satisfied: pymysql in /usr/local/lib/python3.8/dist-packages (1.0.2)\n", "stdout_lines": ["Requirement already satisfied: pymysql in /usr/local/lib/python3.8/dist-packages (1.0.2)"], "version": null, "virtualenv": null}
2022-02-15 11:21:07,460 p=77797 u=pavel n=ansible | TASK [mysql : Started mysql] ****************************************************
2022-02-15 11:21:08,051 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "name": "mysql", "state": "started", "status": {"ActiveEnterTimestamp": "Tue 2022-02-15 09:41:04 MSK", "ActiveEnterTimestampMonotonic": "7220241", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice systemd-journald.socket basic.target -.mount network.target sysinit.target", "AllowIsolate": "no", "AllowedCPUs": "", "AllowedMemoryNodes": "", "AmbientCapabilities": "", "AssertResult": "yes", "AssertTimestamp": "Tue 2022-02-15 09:41:02 MSK", "AssertTimestampMonotonic": "5182068", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "no", "CPUAffinity": "", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanClean": "runtime", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read 0x26 0x27 0x28", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Tue 2022-02-15 09:41:02 MSK", "ConditionTimestampMonotonic": "5182068", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/mysql.service", "ControlPID": "0", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "MySQL Community Server", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveCPUs": "", "EffectiveMemoryNodes": "", "Environment": "MYSQLD_PARENT_PID=1", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "895", "ExecMainStartTimestamp": "Tue 2022-02-15 09:41:02 MSK", "ExecMainStartTimestampMonotonic": "5746144", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/sbin/mysqld ; argv[]=/usr/sbin/mysqld ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/mysqld ; argv[]=/usr/sbin/mysqld ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPre": "{ path=/usr/share/mysql/mysql-systemd-start ; argv[]=/usr/share/mysql/mysql-systemd-start pre ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPreEx": "{ path=/usr/share/mysql/mysql-systemd-start ; argv[]=/usr/share/mysql/mysql-systemd-start pre ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/mysql.service", "GID": "134", "Group": "mysql", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "0", "IOSchedulingPriority": "0", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "mysql.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Tue 2022-02-15 09:41:02 MSK", "InactiveExitTimestampMonotonic": "5184347", "InvocationID": "d6e0889fe69a494d881e49211ed1802d", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "10000", "LimitNOFILESoft": "10000", "LimitNPROC": "15295", "LimitNPROCSoft": "15295", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "15295", "LimitSIGPENDINGSoft": "15295", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "895", "MemoryAccounting": "yes", "MemoryCurrent": "420900864", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "MountFlags": "", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAMask": "", "NUMAPolicy": "n/a", "Names": "mysql.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PIDFile": "/run/mysqld/mysqld.pid", "Perpetual": "no", "PrivateDevices": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target -.mount", "RequiresMountsFor": "/run/mysqld", "Restart": "on-failure", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectory": "mysqld", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardInputData": "", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Tue 2022-02-15 09:41:04 MSK", "StateChangeTimestampMonotonic": "7220241", "StateDirectoryMode": "0755", "StatusErrno": "0", "StatusText": "Server is operational", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "37", "TasksMax": "4588", "TimeoutAbortUSec": "infinity", "TimeoutCleanUSec": "infinity", "TimeoutStartUSec": "infinity", "TimeoutStopUSec": "infinity", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "128", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "mysql", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2022-02-15 11:21:08,061 p=77797 u=pavel n=ansible | TASK [mysql : Set the root password] ********************************************
2022-02-15 11:21:08,138 p=78397 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:21:08,500 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 11:21:08,507 p=77797 u=pavel n=ansible | TASK [mysql : Remove all anonymous user accounts] *******************************
2022-02-15 11:21:08,570 p=78429 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:21:08,821 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 11:21:08,828 p=77797 u=pavel n=ansible | TASK [mysql : Remove the MySQL test database] ***********************************
2022-02-15 11:21:08,910 p=78461 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:21:09,280 p=77797 u=pavel n=ansible | [WARNING]: Module did not set no_log for unsafe_login_password

2022-02-15 11:21:09,281 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "db": "test", "db_list": ["test"], "executed_commands": []}
2022-02-15 11:21:09,288 p=77797 u=pavel n=ansible | TASK [mysql : Creates database] *************************************************
2022-02-15 11:21:09,351 p=78499 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:21:09,609 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "db": "db", "db_list": ["db"], "executed_commands": []}
2022-02-15 11:21:09,617 p=77797 u=pavel n=ansible | TASK [mysql : Create MySQL admin user for database] *****************************
2022-02-15 11:21:09,678 p=78531 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:21:09,970 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 11:21:09,978 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : Include OS-specific variables.] ***********************
2022-02-15 11:21:10,011 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"ansible_facts": {"__nginx_user": "www-data", "nginx_conf_file_path": "/etc/nginx/nginx.conf", "nginx_conf_path": "/etc/nginx/conf.d", "nginx_default_vhost_path": "/etc/nginx/sites-enabled/default", "nginx_mime_file_path": "/etc/nginx/mime.types", "nginx_pidfile": "/run/nginx.pid", "nginx_vhost_path": "/etc/nginx/sites-enabled", "root_group": "root"}, "ansible_included_var_files": ["/home/pavel/ansible-cm/roles/geerlingguy.nginx/vars/Debian.yml"], "changed": false}
2022-02-15 11:21:10,019 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : Define nginx_user.] ***********************************
2022-02-15 11:21:10,058 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"ansible_facts": {"nginx_user": "www-data"}, "changed": false}
2022-02-15 11:21:10,067 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] ****************************************
2022-02-15 11:21:10,100 p=77797 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:21:10,109 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] ****************************************
2022-02-15 11:21:10,160 p=77797 u=pavel n=ansible | included: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/setup-Ubuntu.yml for 192.168.88.28
2022-02-15 11:21:10,169 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure dirmngr is installed (gnupg dependency).] ******
2022-02-15 11:21:11,146 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:21:11,154 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : Add PPA for Nginx (if configured).] *******************
2022-02-15 11:21:11,187 p=77797 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:21:11,194 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx will reinstall if the PPA was just added.] ***
2022-02-15 11:21:11,228 p=77797 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:21:11,236 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] ****************************************
2022-02-15 11:21:11,280 p=77797 u=pavel n=ansible | included: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/setup-Debian.yml for 192.168.88.28
2022-02-15 11:21:11,291 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : Update apt cache.] ************************************
2022-02-15 11:21:11,984 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:21:11,993 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx is installed.] ***************************
2022-02-15 11:21:13,006 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:21:13,014 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] ****************************************
2022-02-15 11:21:13,044 p=77797 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:21:13,051 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] ****************************************
2022-02-15 11:21:13,084 p=77797 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:21:13,092 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] ****************************************
2022-02-15 11:21:13,123 p=77797 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:21:13,130 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : Remove default nginx vhost config file (if configured).] ***
2022-02-15 11:21:13,162 p=77797 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:21:13,169 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx_vhost_path exists.] **********************
2022-02-15 11:21:13,434 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/etc/nginx/sites-enabled", "size": 4096, "state": "directory", "uid": 0}
2022-02-15 11:21:13,442 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : Add managed vhost config files.] **********************
2022-02-15 11:21:13,481 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : Remove managed vhost config files.] *******************
2022-02-15 11:21:13,522 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : Remove legacy vhosts.conf file.] **********************
2022-02-15 11:21:13,805 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "path": "/etc/nginx/sites-enabled/vhosts.conf", "state": "absent"}
2022-02-15 11:21:13,812 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : Copy nginx configuration in place.] *******************
2022-02-15 11:21:14,354 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "checksum": "0b0918e4dfb9031651b7262482e3060fc7667ba5", "dest": "/etc/nginx/nginx.conf", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/nginx/nginx.conf", "size": 883, "state": "file", "uid": 0}
2022-02-15 11:21:14,362 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx service is running as configured.] *******
2022-02-15 11:21:14,784 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "enabled": true, "name": "nginx", "state": "started", "status": {"ActiveEnterTimestamp": "Tue 2022-02-15 10:23:05 MSK", "ActiveEnterTimestampMonotonic": "2530235319", "ActiveExitTimestamp": "Tue 2022-02-15 09:50:21 MSK", "ActiveExitTimestampMonotonic": "566958399", "ActiveState": "active", "After": "system.slice systemd-journald.socket basic.target network.target sysinit.target", "AllowIsolate": "no", "AllowedCPUs": "", "AllowedMemoryNodes": "", "AmbientCapabilities": "", "AssertResult": "yes", "AssertTimestamp": "Tue 2022-02-15 10:23:05 MSK", "AssertTimestampMonotonic": "2530221105", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "no", "CPUAffinity": "", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read 0x26 0x27 0x28", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Tue 2022-02-15 10:23:05 MSK", "ConditionTimestampMonotonic": "2530221105", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/nginx.service", "ControlPID": "0", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "A high performance web server and a reverse proxy server", "DevicePolicy": "auto", "Documentation": "man:nginx(8)", "DynamicUser": "no", "EffectiveCPUs": "", "EffectiveMemoryNodes": "", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "28442", "ExecMainStartTimestamp": "Tue 2022-02-15 10:23:05 MSK", "ExecMainStartTimestampMonotonic": "2530235301", "ExecMainStatus": "0", "ExecReload": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; ignore_errors=no ; start_time=[Tue 2022-02-15 10:24:13 MSK] ; stop_time=[Tue 2022-02-15 10:24:13 MSK] ; pid=34838 ; code=exited ; status=0 }", "ExecReloadEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; flags= ; start_time=[Tue 2022-02-15 10:24:13 MSK] ; stop_time=[Tue 2022-02-15 10:24:13 MSK] ; pid=34838 ; code=exited ; status=0 }", "ExecStart": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPre": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPreEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStop": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; ignore_errors=yes ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStopEx": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; flags=ignore-failure ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/nginx.service", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "0", "IOSchedulingPriority": "0", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "nginx.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Tue 2022-02-15 10:21:12 MSK", "InactiveEnterTimestampMonotonic": "2417569318", "InactiveExitTimestamp": "Tue 2022-02-15 10:23:05 MSK", "InactiveExitTimestampMonotonic": "2530223057", "InvocationID": "b65f8dd35c4a4016876e6d5436f981ce", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "15295", "LimitNPROCSoft": "15295", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "15295", "LimitSIGPENDINGSoft": "15295", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "28442", "MemoryAccounting": "yes", "MemoryCurrent": "2875392", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "MountFlags": "", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAMask": "", "NUMAPolicy": "n/a", "Names": "nginx.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PIDFile": "/run/nginx.pid", "Perpetual": "no", "PrivateDevices": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "no", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardInputData": "", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Tue 2022-02-15 10:24:13 MSK", "StateChangeTimestampMonotonic": "2598661082", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "3", "TasksMax": "4588", "TimeoutAbortUSec": "5s", "TimeoutCleanUSec": "infinity", "TimeoutStartUSec": "1min 30s", "TimeoutStopUSec": "5s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "forking", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2022-02-15 11:21:14,794 p=77797 u=pavel n=ansible | TASK [geerlingguy.nginx : Check URL] ********************************************
2022-02-15 11:21:15,247 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"accept_ranges": "bytes", "changed": false, "connection": "close", "content_length": "612", "content_type": "text/html", "cookies": {}, "cookies_string": "", "date": "Tue, 15 Feb 2022 08:21:15 GMT", "elapsed": 0, "etag": "\"62011295-264\"", "last_modified": "Mon, 07 Feb 2022 12:37:41 GMT", "msg": "OK (612 bytes)", "redirected": false, "server": "nginx/1.18.0 (Ubuntu)", "status": 200, "url": "http://192.168.88.28"}
2022-02-15 11:21:15,256 p=77797 u=pavel n=ansible | TASK [php : Ensure PHP server and plugins is present using apt] *****************
2022-02-15 11:21:16,298 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:21:16,307 p=77797 u=pavel n=ansible | TASK [wordpress : Creates directory] ********************************************
2022-02-15 11:21:16,561 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 33, "group": "www-data", "mode": "0755", "owner": "www-data", "path": "/var/www/http_host", "size": 4096, "state": "directory", "uid": 33}
2022-02-15 11:21:16,568 p=77797 u=pavel n=ansible | TASK [wordpress : Download and unpack latest WordPress] *************************
2022-02-15 11:21:16,672 p=77797 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "msg": "skipped, since /var/www/http_host/wordpress exists"}
2022-02-15 11:21:16,680 p=77797 u=pavel n=ansible | TASK [wordpress : Set ownership] ************************************************
2022-02-15 11:21:17,108 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 33, "group": "www-data", "mode": "0755", "owner": "www-data", "path": "/var/www/http_host", "size": 4096, "state": "directory", "uid": 33}
2022-02-15 11:21:17,115 p=77797 u=pavel n=ansible | TASK [wordpress : Set permissions for directories] ******************************
2022-02-15 11:21:17,745 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "cmd": "/usr/bin/find /var/www/http_host/wordpress/ -type d -exec chmod 750 {} \\;", "delta": "0:00:00.272883", "end": "2022-02-15 11:21:17.710064", "msg": "", "rc": 0, "start": "2022-02-15 11:21:17.437181", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-02-15 11:21:17,752 p=77797 u=pavel n=ansible | TASK [wordpress : Set permissions for files] ************************************
2022-02-15 11:21:20,278 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "cmd": "/usr/bin/find /var/www/http_host/wordpress/ -type f -exec chmod 640 {} \\;", "delta": "0:00:02.246387", "end": "2022-02-15 11:21:20.242558", "msg": "", "rc": 0, "start": "2022-02-15 11:21:17.996171", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-02-15 11:21:20,285 p=77797 u=pavel n=ansible | TASK [wordpress : Set up wp-config] *********************************************
2022-02-15 11:21:20,927 p=77797 u=pavel n=ansible | changed: [192.168.88.28] => {"changed": true, "checksum": "ca820c219cb4e77956b426d7b9c59517a64a148f", "dest": "/var/www/http_host/wordpress/wp-config.php", "gid": 33, "group": "www-data", "md5sum": "6ab3280e4fe1cd8d6ae5db51e2022a8b", "mode": "0640", "owner": "www-data", "size": 3131, "src": "/home/pavel/.ansible/tmp/ansible-tmp-1644913280.3305402-82212-255118704358573/source", "state": "file", "uid": 33}
2022-02-15 11:21:20,934 p=77797 u=pavel n=ansible | TASK [wordpress : Add site to sites folder in Nginx] ****************************
2022-02-15 11:21:21,430 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "checksum": "673bd3011f8837e4c1aa3c6dd0052d7db1889327", "dest": "/etc/nginx/sites-available/wordpress", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/nginx/sites-available/wordpress", "size": 968, "state": "file", "uid": 0}
2022-02-15 11:21:21,438 p=77797 u=pavel n=ansible | TASK [wordpress : Activate activate site] ***************************************
2022-02-15 11:21:21,735 p=77797 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "dest": "/etc/nginx/sites-enabled/wordpress", "gid": 0, "group": "root", "mode": "0777", "owner": "root", "size": 36, "src": "/etc/nginx/sites-available/wordpress", "state": "link", "uid": 0}
2022-02-15 11:21:21,743 p=77797 u=pavel n=ansible | META: ran handlers
2022-02-15 11:21:21,750 p=77797 u=pavel n=ansible | META: ran handlers
2022-02-15 11:21:21,751 p=77797 u=pavel n=ansible | PLAY RECAP **********************************************************************
2022-02-15 11:21:21,751 p=77797 u=pavel n=ansible | 192.168.88.28              : ok=35   changed=2    unreachable=0    failed=0    skipped=10   rescued=0    ignored=0   
2022-02-15 11:29:29,509 p=85362 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 11:29:29,509 p=85362 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 11:29:34,061 p=85362 u=pavel n=ansible | ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each:
JSON: Expecting value: line 1 column 1 (char 0)

Syntax Error while loading YAML.
  mapping values are not allowed in this context

The error appears to be in '/home/pavel/ansible-cm/roles/mysql/tasks/main.yml': line 75, column 9, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

- name: check if DB exists
   shell: mysql -e 'SHOW DATABASES;' | grep {{ B_database }}
        ^ here
We could be wrong, but this one looks like it might be an issue with
missing quotes. Always quote template expression brackets when they
start a value. For instance:

    with_items:
      - {{ foo }}

Should be written as:

    with_items:
      - "{{ foo }}"

2022-02-15 11:36:56,151 p=88066 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 11:36:56,151 p=88066 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 11:37:01,998 p=88066 u=pavel n=ansible | ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each:
JSON: Expecting value: line 1 column 1 (char 0)

Syntax Error while loading YAML.
  did not find expected key

The error appears to be in '/home/pavel/ansible-cm/roles/mysql/tasks/main.yml': line 61, column 18, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

    login_password: "{{ root_password }}"
  tags: [ mysql ]i
                 ^ here

2022-02-15 11:38:20,049 p=88575 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 11:38:20,049 p=88575 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 11:38:23,893 p=88575 u=pavel n=ansible | ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each:
JSON: Expecting value: line 1 column 1 (char 0)

Syntax Error while loading YAML.
  did not find expected key

The error appears to be in '/home/pavel/ansible-cm/roles/mysql/tasks/main.yml': line 61, column 18, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

    login_password: "{{ root_password }}"
  tags: [ mysql ]i
                 ^ here

2022-02-15 11:39:33,945 p=89215 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 11:39:33,946 p=89215 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 11:39:37,880 p=89215 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:39:37,882 p=89215 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:39:37,883 p=89215 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:39:37,884 p=89215 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:39:37,885 p=89215 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:39:37,887 p=89215 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:39:37,898 p=89215 u=pavel n=ansible | statically imported: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/vhosts.yml
2022-02-15 11:39:37,917 p=89215 u=pavel n=ansible | Skipping callback 'default', as we already have a stdout callback.
2022-02-15 11:39:37,917 p=89215 u=pavel n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2022-02-15 11:39:37,917 p=89215 u=pavel n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2022-02-15 11:39:37,918 p=89215 u=pavel n=ansible | PLAYBOOK: playbook.yml ********************************************************************************************************************************************************************************
2022-02-15 11:39:37,918 p=89215 u=pavel n=ansible | 2 plays in playbook.yml
2022-02-15 11:39:37,919 p=89215 u=pavel n=ansible | PLAY [Prepare user] ***********************************************************************************************************************************************************************************
2022-02-15 11:39:37,930 p=89215 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 11:39:39,149 p=89215 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 11:39:39,157 p=89215 u=pavel n=ansible | META: ran handlers
2022-02-15 11:39:39,164 p=89215 u=pavel n=ansible | TASK [user : Create group] ****************************************************************************************************************************************************************************
2022-02-15 11:39:39,539 p=89215 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 1001, "name": "app", "state": "present", "system": false}
2022-02-15 11:39:39,547 p=89215 u=pavel n=ansible | TASK [user : Create user] *****************************************************************************************************************************************************************************
2022-02-15 11:39:40,050 p=89215 u=pavel n=ansible | changed: [192.168.88.28] => {"append": false, "changed": true, "comment": "", "group": 1001, "home": "/home/app", "move_home": false, "name": "app", "password": "NOT_LOGGING_PASSWORD", "shell": "/bin/bash", "state": "present", "uid": 1001}
2022-02-15 11:39:40,058 p=89215 u=pavel n=ansible | TASK [user : Create directory] ************************************************************************************************************************************************************************
2022-02-15 11:39:40,464 p=89215 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 1001, "group": "app", "mode": "0755", "owner": "app", "path": "/home/app/test_dir", "size": 4096, "state": "directory", "uid": 1001}
2022-02-15 11:39:40,472 p=89215 u=pavel n=ansible | TASK [user : Copy file to remote host] ****************************************************************************************************************************************************************
2022-02-15 11:39:41,382 p=89215 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "checksum": "03840deb949d6cf0c0a624fa7eba87fbdbcb7783", "dest": "/home/app/test_dir/test.txt", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/home/app/test_dir/test.txt", "size": 10, "state": "file", "uid": 0}
2022-02-15 11:39:41,389 p=89215 u=pavel n=ansible | TASK [user : Install packages] ************************************************************************************************************************************************************************
2022-02-15 11:39:42,581 p=89215 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:39:42,588 p=89215 u=pavel n=ansible | META: ran handlers
2022-02-15 11:39:42,594 p=89215 u=pavel n=ansible | META: ran handlers
2022-02-15 11:39:42,597 p=89215 u=pavel n=ansible | PLAY [Add apps] ***************************************************************************************************************************************************************************************
2022-02-15 11:39:42,612 p=89215 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 11:39:43,303 p=89215 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 11:39:43,310 p=89215 u=pavel n=ansible | META: ran handlers
2022-02-15 11:39:43,316 p=89215 u=pavel n=ansible | TASK [mysql : Ensure packages is present using apt] ***************************************************************************************************************************************************
2022-02-15 11:39:44,454 p=89215 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:39:44,461 p=89215 u=pavel n=ansible | TASK [mysql : Ensure pymysql is present using pip] ****************************************************************************************************************************************************
2022-02-15 11:39:46,031 p=89215 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "cmd": ["/usr/bin/pip3", "install", "pymysql"], "name": ["pymysql"], "requirements": null, "state": "present", "stderr": "", "stderr_lines": [], "stdout": "Requirement already satisfied: pymysql in /usr/local/lib/python3.8/dist-packages (1.0.2)\n", "stdout_lines": ["Requirement already satisfied: pymysql in /usr/local/lib/python3.8/dist-packages (1.0.2)"], "version": null, "virtualenv": null}
2022-02-15 11:39:46,038 p=89215 u=pavel n=ansible | TASK [mysql : Started mysql] **************************************************************************************************************************************************************************
2022-02-15 11:39:46,657 p=89215 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "name": "mysql", "state": "started", "status": {"ActiveEnterTimestamp": "Tue 2022-02-15 09:41:04 MSK", "ActiveEnterTimestampMonotonic": "7220241", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice systemd-journald.socket basic.target -.mount network.target sysinit.target", "AllowIsolate": "no", "AllowedCPUs": "", "AllowedMemoryNodes": "", "AmbientCapabilities": "", "AssertResult": "yes", "AssertTimestamp": "Tue 2022-02-15 09:41:02 MSK", "AssertTimestampMonotonic": "5182068", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "no", "CPUAffinity": "", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanClean": "runtime", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read 0x26 0x27 0x28", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Tue 2022-02-15 09:41:02 MSK", "ConditionTimestampMonotonic": "5182068", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/mysql.service", "ControlPID": "0", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "MySQL Community Server", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveCPUs": "", "EffectiveMemoryNodes": "", "Environment": "MYSQLD_PARENT_PID=1", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "895", "ExecMainStartTimestamp": "Tue 2022-02-15 09:41:02 MSK", "ExecMainStartTimestampMonotonic": "5746144", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/sbin/mysqld ; argv[]=/usr/sbin/mysqld ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/mysqld ; argv[]=/usr/sbin/mysqld ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPre": "{ path=/usr/share/mysql/mysql-systemd-start ; argv[]=/usr/share/mysql/mysql-systemd-start pre ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPreEx": "{ path=/usr/share/mysql/mysql-systemd-start ; argv[]=/usr/share/mysql/mysql-systemd-start pre ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/mysql.service", "GID": "134", "Group": "mysql", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "0", "IOSchedulingPriority": "0", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "mysql.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Tue 2022-02-15 09:41:02 MSK", "InactiveExitTimestampMonotonic": "5184347", "InvocationID": "d6e0889fe69a494d881e49211ed1802d", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "10000", "LimitNOFILESoft": "10000", "LimitNPROC": "15295", "LimitNPROCSoft": "15295", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "15295", "LimitSIGPENDINGSoft": "15295", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "895", "MemoryAccounting": "yes", "MemoryCurrent": "421183488", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "MountFlags": "", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAMask": "", "NUMAPolicy": "n/a", "Names": "mysql.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PIDFile": "/run/mysqld/mysqld.pid", "Perpetual": "no", "PrivateDevices": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target -.mount", "RequiresMountsFor": "/run/mysqld", "Restart": "on-failure", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectory": "mysqld", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardInputData": "", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Tue 2022-02-15 09:41:04 MSK", "StateChangeTimestampMonotonic": "7220241", "StateDirectoryMode": "0755", "StatusErrno": "0", "StatusText": "Server is operational", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "37", "TasksMax": "4588", "TimeoutAbortUSec": "infinity", "TimeoutCleanUSec": "infinity", "TimeoutStartUSec": "infinity", "TimeoutStopUSec": "infinity", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "128", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "mysql", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2022-02-15 11:39:46,667 p=89215 u=pavel n=ansible | TASK [mysql : Set the root password] ******************************************************************************************************************************************************************
2022-02-15 11:39:46,738 p=89809 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:39:47,108 p=89215 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 11:39:47,116 p=89215 u=pavel n=ansible | TASK [mysql : Remove all anonymous user accounts] *****************************************************************************************************************************************************
2022-02-15 11:39:47,181 p=89847 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:39:47,445 p=89215 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 11:39:47,452 p=89215 u=pavel n=ansible | TASK [mysql : Remove the MySQL test database] *********************************************************************************************************************************************************
2022-02-15 11:39:47,515 p=89879 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:39:47,930 p=89215 u=pavel n=ansible | [WARNING]: Module did not set no_log for unsafe_login_password

2022-02-15 11:39:47,931 p=89215 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "db": "test", "db_list": ["test"], "executed_commands": []}
2022-02-15 11:39:47,938 p=89215 u=pavel n=ansible | TASK [mysql : Creates database] ***********************************************************************************************************************************************************************
2022-02-15 11:39:47,997 p=89921 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:39:48,253 p=89215 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "db": "db", "db_list": ["db"], "executed_commands": []}
2022-02-15 11:39:48,261 p=89215 u=pavel n=ansible | TASK [mysql : Create MySQL admin user for database] ***************************************************************************************************************************************************
2022-02-15 11:39:48,327 p=89953 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:39:48,610 p=89215 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 11:39:48,618 p=89215 u=pavel n=ansible | TASK [mysql : Chek connection to DB] ******************************************************************************************************************************************************************
2022-02-15 11:39:48,684 p=89985 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:39:48,938 p=89215 u=pavel n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible_collections.community.mysql.plugins.module_utils.database.SQLParseError: Identifier name unspecified or unquoted trailing dot
2022-02-15 11:39:48,939 p=89215 u=pavel n=ansible | fatal: [192.168.88.28]: FAILED! => {"changed": false, "msg": "error creating database: Identifier name unspecified or unquoted trailing dot"}
2022-02-15 11:39:48,941 p=89215 u=pavel n=ansible | PLAY RECAP ********************************************************************************************************************************************************************************************
2022-02-15 11:39:48,941 p=89215 u=pavel n=ansible | 192.168.88.28              : ok=15   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2022-02-15 11:42:16,088 p=90907 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 11:42:16,089 p=90907 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 11:42:19,997 p=90907 u=pavel n=ansible | ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each:
JSON: Expecting value: line 1 column 1 (char 0)

Syntax Error while loading YAML.
  mapping values are not allowed in this context

The error appears to be in '/home/pavel/ansible-cm/roles/mysql/tasks/main.yml': line 75, column 10, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

- name: check if DB exists
    shell: mysql -e -u "{{ user_name }}" -p "{{ user_pass }}" 'SHOW DATABASES;' | grep {{ B_database }}
         ^ here
We could be wrong, but this one looks like it might be an issue with
missing quotes. Always quote template expression brackets when they
start a value. For instance:

    with_items:
      - {{ foo }}

Should be written as:

    with_items:
      - "{{ foo }}"

2022-02-15 11:45:03,407 p=91917 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 11:45:03,407 p=91917 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 11:45:08,584 p=91917 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:45:08,586 p=91917 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:45:08,587 p=91917 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:45:08,588 p=91917 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:45:08,589 p=91917 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:45:08,601 p=91917 u=pavel n=ansible | statically imported: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/vhosts.yml
2022-02-15 11:45:08,620 p=91917 u=pavel n=ansible | Skipping callback 'default', as we already have a stdout callback.
2022-02-15 11:45:08,620 p=91917 u=pavel n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2022-02-15 11:45:08,620 p=91917 u=pavel n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2022-02-15 11:45:08,620 p=91917 u=pavel n=ansible | PLAYBOOK: playbook.yml ********************************************************************************************************************************************************************************
2022-02-15 11:45:08,620 p=91917 u=pavel n=ansible | 2 plays in playbook.yml
2022-02-15 11:45:08,622 p=91917 u=pavel n=ansible | PLAY [Prepare user] ***********************************************************************************************************************************************************************************
2022-02-15 11:45:08,631 p=91917 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 11:45:09,779 p=91917 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 11:45:09,786 p=91917 u=pavel n=ansible | META: ran handlers
2022-02-15 11:45:09,793 p=91917 u=pavel n=ansible | TASK [user : Create group] ****************************************************************************************************************************************************************************
2022-02-15 11:45:10,180 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 1001, "name": "app", "state": "present", "system": false}
2022-02-15 11:45:10,187 p=91917 u=pavel n=ansible | TASK [user : Create user] *****************************************************************************************************************************************************************************
2022-02-15 11:45:10,638 p=91917 u=pavel n=ansible | changed: [192.168.88.28] => {"append": false, "changed": true, "comment": "", "group": 1001, "home": "/home/app", "move_home": false, "name": "app", "password": "NOT_LOGGING_PASSWORD", "shell": "/bin/bash", "state": "present", "uid": 1001}
2022-02-15 11:45:10,644 p=91917 u=pavel n=ansible | TASK [user : Create directory] ************************************************************************************************************************************************************************
2022-02-15 11:45:11,047 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 1001, "group": "app", "mode": "0755", "owner": "app", "path": "/home/app/test_dir", "size": 4096, "state": "directory", "uid": 1001}
2022-02-15 11:45:11,054 p=91917 u=pavel n=ansible | TASK [user : Copy file to remote host] ****************************************************************************************************************************************************************
2022-02-15 11:45:11,933 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "checksum": "03840deb949d6cf0c0a624fa7eba87fbdbcb7783", "dest": "/home/app/test_dir/test.txt", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/home/app/test_dir/test.txt", "size": 10, "state": "file", "uid": 0}
2022-02-15 11:45:11,941 p=91917 u=pavel n=ansible | TASK [user : Install packages] ************************************************************************************************************************************************************************
2022-02-15 11:45:13,111 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:45:13,118 p=91917 u=pavel n=ansible | META: ran handlers
2022-02-15 11:45:13,124 p=91917 u=pavel n=ansible | META: ran handlers
2022-02-15 11:45:13,128 p=91917 u=pavel n=ansible | PLAY [Add apps] ***************************************************************************************************************************************************************************************
2022-02-15 11:45:13,143 p=91917 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 11:45:13,831 p=91917 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 11:45:13,838 p=91917 u=pavel n=ansible | META: ran handlers
2022-02-15 11:45:13,845 p=91917 u=pavel n=ansible | TASK [mysql : Ensure packages is present using apt] ***************************************************************************************************************************************************
2022-02-15 11:45:14,994 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:45:15,001 p=91917 u=pavel n=ansible | TASK [mysql : Ensure pymysql is present using pip] ****************************************************************************************************************************************************
2022-02-15 11:45:16,479 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "cmd": ["/usr/bin/pip3", "install", "pymysql"], "name": ["pymysql"], "requirements": null, "state": "present", "stderr": "", "stderr_lines": [], "stdout": "Requirement already satisfied: pymysql in /usr/local/lib/python3.8/dist-packages (1.0.2)\n", "stdout_lines": ["Requirement already satisfied: pymysql in /usr/local/lib/python3.8/dist-packages (1.0.2)"], "version": null, "virtualenv": null}
2022-02-15 11:45:16,486 p=91917 u=pavel n=ansible | TASK [mysql : Started mysql] **************************************************************************************************************************************************************************
2022-02-15 11:45:17,078 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "name": "mysql", "state": "started", "status": {"ActiveEnterTimestamp": "Tue 2022-02-15 09:41:04 MSK", "ActiveEnterTimestampMonotonic": "7220241", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice systemd-journald.socket basic.target -.mount network.target sysinit.target", "AllowIsolate": "no", "AllowedCPUs": "", "AllowedMemoryNodes": "", "AmbientCapabilities": "", "AssertResult": "yes", "AssertTimestamp": "Tue 2022-02-15 09:41:02 MSK", "AssertTimestampMonotonic": "5182068", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "no", "CPUAffinity": "", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanClean": "runtime", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read 0x26 0x27 0x28", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Tue 2022-02-15 09:41:02 MSK", "ConditionTimestampMonotonic": "5182068", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/mysql.service", "ControlPID": "0", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "MySQL Community Server", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveCPUs": "", "EffectiveMemoryNodes": "", "Environment": "MYSQLD_PARENT_PID=1", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "895", "ExecMainStartTimestamp": "Tue 2022-02-15 09:41:02 MSK", "ExecMainStartTimestampMonotonic": "5746144", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/sbin/mysqld ; argv[]=/usr/sbin/mysqld ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/mysqld ; argv[]=/usr/sbin/mysqld ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPre": "{ path=/usr/share/mysql/mysql-systemd-start ; argv[]=/usr/share/mysql/mysql-systemd-start pre ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPreEx": "{ path=/usr/share/mysql/mysql-systemd-start ; argv[]=/usr/share/mysql/mysql-systemd-start pre ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/mysql.service", "GID": "134", "Group": "mysql", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "0", "IOSchedulingPriority": "0", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "mysql.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Tue 2022-02-15 09:41:02 MSK", "InactiveExitTimestampMonotonic": "5184347", "InvocationID": "d6e0889fe69a494d881e49211ed1802d", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "10000", "LimitNOFILESoft": "10000", "LimitNPROC": "15295", "LimitNPROCSoft": "15295", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "15295", "LimitSIGPENDINGSoft": "15295", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "895", "MemoryAccounting": "yes", "MemoryCurrent": "421183488", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "MountFlags": "", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAMask": "", "NUMAPolicy": "n/a", "Names": "mysql.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PIDFile": "/run/mysqld/mysqld.pid", "Perpetual": "no", "PrivateDevices": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target -.mount", "RequiresMountsFor": "/run/mysqld", "Restart": "on-failure", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectory": "mysqld", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardInputData": "", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Tue 2022-02-15 09:41:04 MSK", "StateChangeTimestampMonotonic": "7220241", "StateDirectoryMode": "0755", "StatusErrno": "0", "StatusText": "Server is operational", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "37", "TasksMax": "4588", "TimeoutAbortUSec": "infinity", "TimeoutCleanUSec": "infinity", "TimeoutStartUSec": "infinity", "TimeoutStopUSec": "infinity", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "128", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "mysql", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2022-02-15 11:45:17,085 p=91917 u=pavel n=ansible | TASK [mysql : Set the root password] ******************************************************************************************************************************************************************
2022-02-15 11:45:17,167 p=92530 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:45:17,524 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 11:45:17,531 p=91917 u=pavel n=ansible | TASK [mysql : Remove all anonymous user accounts] *****************************************************************************************************************************************************
2022-02-15 11:45:17,591 p=92562 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:45:17,850 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 11:45:17,858 p=91917 u=pavel n=ansible | TASK [mysql : Remove the MySQL test database] *********************************************************************************************************************************************************
2022-02-15 11:45:17,924 p=92594 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:45:18,335 p=91917 u=pavel n=ansible | [WARNING]: Module did not set no_log for unsafe_login_password

2022-02-15 11:45:18,336 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "db": "test", "db_list": ["test"], "executed_commands": []}
2022-02-15 11:45:18,343 p=91917 u=pavel n=ansible | TASK [mysql : Creates database] ***********************************************************************************************************************************************************************
2022-02-15 11:45:18,404 p=92633 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:45:18,653 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "db": "db", "db_list": ["db"], "executed_commands": []}
2022-02-15 11:45:18,661 p=91917 u=pavel n=ansible | TASK [mysql : Create MySQL admin user for database] ***************************************************************************************************************************************************
2022-02-15 11:45:18,723 p=92665 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:45:18,991 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 11:45:18,999 p=91917 u=pavel n=ansible | TASK [mysql : check if DB exists] *********************************************************************************************************************************************************************
2022-02-15 11:45:19,384 p=91917 u=pavel n=ansible | changed: [192.168.88.28] => {"changed": true, "cmd": "mysql --host=localhost --user=user --password=pass -e 'SHOW DATABASES;' | grep -c db", "delta": "0:00:00.010234", "end": "2022-02-15 11:45:19.351466", "failed_when_result": false, "msg": "", "rc": 0, "start": "2022-02-15 11:45:19.341232", "stderr": "mysql: [Warning] Using a password on the command line interface can be insecure.", "stderr_lines": ["mysql: [Warning] Using a password on the command line interface can be insecure."], "stdout": "1", "stdout_lines": ["1"]}
2022-02-15 11:45:19,391 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : Include OS-specific variables.] *********************************************************************************************************************************************
2022-02-15 11:45:19,424 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"ansible_facts": {"__nginx_user": "www-data", "nginx_conf_file_path": "/etc/nginx/nginx.conf", "nginx_conf_path": "/etc/nginx/conf.d", "nginx_default_vhost_path": "/etc/nginx/sites-enabled/default", "nginx_mime_file_path": "/etc/nginx/mime.types", "nginx_pidfile": "/run/nginx.pid", "nginx_vhost_path": "/etc/nginx/sites-enabled", "root_group": "root"}, "ansible_included_var_files": ["/home/pavel/ansible-cm/roles/geerlingguy.nginx/vars/Debian.yml"], "changed": false}
2022-02-15 11:45:19,433 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : Define nginx_user.] *********************************************************************************************************************************************************
2022-02-15 11:45:19,471 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"ansible_facts": {"nginx_user": "www-data"}, "changed": false}
2022-02-15 11:45:19,478 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 11:45:19,516 p=91917 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:45:19,529 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 11:45:19,584 p=91917 u=pavel n=ansible | included: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/setup-Ubuntu.yml for 192.168.88.28
2022-02-15 11:45:19,593 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure dirmngr is installed (gnupg dependency).] ****************************************************************************************************************************
2022-02-15 11:45:20,571 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:45:20,578 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : Add PPA for Nginx (if configured).] *****************************************************************************************************************************************
2022-02-15 11:45:20,610 p=91917 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:45:20,618 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx will reinstall if the PPA was just added.] *********************************************************************************************************************
2022-02-15 11:45:20,649 p=91917 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:45:20,659 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 11:45:20,700 p=91917 u=pavel n=ansible | included: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/setup-Debian.yml for 192.168.88.28
2022-02-15 11:45:20,710 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : Update apt cache.] **********************************************************************************************************************************************************
2022-02-15 11:45:21,409 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:45:21,417 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx is installed.] *************************************************************************************************************************************************
2022-02-15 11:45:22,422 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:45:22,429 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 11:45:22,460 p=91917 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:45:22,468 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 11:45:22,501 p=91917 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:45:22,510 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 11:45:22,542 p=91917 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:45:22,551 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : Remove default nginx vhost config file (if configured).] ********************************************************************************************************************
2022-02-15 11:45:22,596 p=91917 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:45:22,603 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx_vhost_path exists.] ********************************************************************************************************************************************
2022-02-15 11:45:22,866 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/etc/nginx/sites-enabled", "size": 4096, "state": "directory", "uid": 0}
2022-02-15 11:45:22,873 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : Add managed vhost config files.] ********************************************************************************************************************************************
2022-02-15 11:45:22,913 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : Remove managed vhost config files.] *****************************************************************************************************************************************
2022-02-15 11:45:22,987 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : Remove legacy vhosts.conf file.] ********************************************************************************************************************************************
2022-02-15 11:45:23,281 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "path": "/etc/nginx/sites-enabled/vhosts.conf", "state": "absent"}
2022-02-15 11:45:23,288 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : Copy nginx configuration in place.] *****************************************************************************************************************************************
2022-02-15 11:45:23,778 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "checksum": "0b0918e4dfb9031651b7262482e3060fc7667ba5", "dest": "/etc/nginx/nginx.conf", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/nginx/nginx.conf", "size": 883, "state": "file", "uid": 0}
2022-02-15 11:45:23,784 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx service is running as configured.] *****************************************************************************************************************************
2022-02-15 11:45:24,200 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "enabled": true, "name": "nginx", "state": "started", "status": {"ActiveEnterTimestamp": "Tue 2022-02-15 10:23:05 MSK", "ActiveEnterTimestampMonotonic": "2530235319", "ActiveExitTimestamp": "Tue 2022-02-15 09:50:21 MSK", "ActiveExitTimestampMonotonic": "566958399", "ActiveState": "active", "After": "system.slice systemd-journald.socket basic.target network.target sysinit.target", "AllowIsolate": "no", "AllowedCPUs": "", "AllowedMemoryNodes": "", "AmbientCapabilities": "", "AssertResult": "yes", "AssertTimestamp": "Tue 2022-02-15 10:23:05 MSK", "AssertTimestampMonotonic": "2530221105", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "no", "CPUAffinity": "", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read 0x26 0x27 0x28", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Tue 2022-02-15 10:23:05 MSK", "ConditionTimestampMonotonic": "2530221105", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/nginx.service", "ControlPID": "0", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "A high performance web server and a reverse proxy server", "DevicePolicy": "auto", "Documentation": "man:nginx(8)", "DynamicUser": "no", "EffectiveCPUs": "", "EffectiveMemoryNodes": "", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "28442", "ExecMainStartTimestamp": "Tue 2022-02-15 10:23:05 MSK", "ExecMainStartTimestampMonotonic": "2530235301", "ExecMainStatus": "0", "ExecReload": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; ignore_errors=no ; start_time=[Tue 2022-02-15 10:24:13 MSK] ; stop_time=[Tue 2022-02-15 10:24:13 MSK] ; pid=34838 ; code=exited ; status=0 }", "ExecReloadEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; flags= ; start_time=[Tue 2022-02-15 10:24:13 MSK] ; stop_time=[Tue 2022-02-15 10:24:13 MSK] ; pid=34838 ; code=exited ; status=0 }", "ExecStart": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPre": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPreEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStop": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; ignore_errors=yes ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStopEx": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; flags=ignore-failure ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/nginx.service", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "0", "IOSchedulingPriority": "0", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "nginx.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Tue 2022-02-15 10:21:12 MSK", "InactiveEnterTimestampMonotonic": "2417569318", "InactiveExitTimestamp": "Tue 2022-02-15 10:23:05 MSK", "InactiveExitTimestampMonotonic": "2530223057", "InvocationID": "b65f8dd35c4a4016876e6d5436f981ce", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "15295", "LimitNPROCSoft": "15295", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "15295", "LimitSIGPENDINGSoft": "15295", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "28442", "MemoryAccounting": "yes", "MemoryCurrent": "2875392", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "MountFlags": "", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAMask": "", "NUMAPolicy": "n/a", "Names": "nginx.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PIDFile": "/run/nginx.pid", "Perpetual": "no", "PrivateDevices": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "no", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardInputData": "", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Tue 2022-02-15 10:24:13 MSK", "StateChangeTimestampMonotonic": "2598661082", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "3", "TasksMax": "4588", "TimeoutAbortUSec": "5s", "TimeoutCleanUSec": "infinity", "TimeoutStartUSec": "1min 30s", "TimeoutStopUSec": "5s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "forking", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2022-02-15 11:45:24,208 p=91917 u=pavel n=ansible | TASK [geerlingguy.nginx : Check URL] ******************************************************************************************************************************************************************
2022-02-15 11:45:24,648 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"accept_ranges": "bytes", "changed": false, "connection": "close", "content_length": "612", "content_type": "text/html", "cookies": {}, "cookies_string": "", "date": "Tue, 15 Feb 2022 08:45:24 GMT", "elapsed": 0, "etag": "\"62011295-264\"", "last_modified": "Mon, 07 Feb 2022 12:37:41 GMT", "msg": "OK (612 bytes)", "redirected": false, "server": "nginx/1.18.0 (Ubuntu)", "status": 200, "url": "http://192.168.88.28"}
2022-02-15 11:45:24,655 p=91917 u=pavel n=ansible | TASK [php : Ensure PHP server and plugins is present using apt] ***************************************************************************************************************************************
2022-02-15 11:45:25,644 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:45:25,653 p=91917 u=pavel n=ansible | TASK [wordpress : Creates directory] ******************************************************************************************************************************************************************
2022-02-15 11:45:25,914 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 33, "group": "www-data", "mode": "0755", "owner": "www-data", "path": "/var/www/http_host", "size": 4096, "state": "directory", "uid": 33}
2022-02-15 11:45:25,921 p=91917 u=pavel n=ansible | TASK [wordpress : Download and unpack latest WordPress] ***********************************************************************************************************************************************
2022-02-15 11:45:26,035 p=91917 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "msg": "skipped, since /var/www/http_host/wordpress exists"}
2022-02-15 11:45:26,043 p=91917 u=pavel n=ansible | TASK [wordpress : Set ownership] **********************************************************************************************************************************************************************
2022-02-15 11:45:26,465 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 33, "group": "www-data", "mode": "0755", "owner": "www-data", "path": "/var/www/http_host", "size": 4096, "state": "directory", "uid": 33}
2022-02-15 11:45:26,472 p=91917 u=pavel n=ansible | TASK [wordpress : Set permissions for directories] ****************************************************************************************************************************************************
2022-02-15 11:45:26,989 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "cmd": "/usr/bin/find /var/www/http_host/wordpress/ -type d -exec chmod 750 {} \\;", "delta": "0:00:00.241432", "end": "2022-02-15 11:45:26.950671", "msg": "", "rc": 0, "start": "2022-02-15 11:45:26.709239", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-02-15 11:45:27,004 p=91917 u=pavel n=ansible | TASK [wordpress : Set permissions for files] **********************************************************************************************************************************************************
2022-02-15 11:45:29,472 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "cmd": "/usr/bin/find /var/www/http_host/wordpress/ -type f -exec chmod 640 {} \\;", "delta": "0:00:02.186315", "end": "2022-02-15 11:45:29.436793", "msg": "", "rc": 0, "start": "2022-02-15 11:45:27.250478", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-02-15 11:45:29,480 p=91917 u=pavel n=ansible | TASK [wordpress : Set up wp-config] *******************************************************************************************************************************************************************
2022-02-15 11:45:30,146 p=91917 u=pavel n=ansible | changed: [192.168.88.28] => {"changed": true, "checksum": "cee6a13ccdc88b79a49603e7671297385c3db14a", "dest": "/var/www/http_host/wordpress/wp-config.php", "gid": 33, "group": "www-data", "md5sum": "a9a99d5ddc96eb18341bec01fcc16c31", "mode": "0640", "owner": "www-data", "size": 3131, "src": "/home/pavel/.ansible/tmp/ansible-tmp-1644914729.5234678-96382-86718381394456/source", "state": "file", "uid": 33}
2022-02-15 11:45:30,154 p=91917 u=pavel n=ansible | TASK [wordpress : Add site to sites folder in Nginx] **************************************************************************************************************************************************
2022-02-15 11:45:30,641 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "checksum": "673bd3011f8837e4c1aa3c6dd0052d7db1889327", "dest": "/etc/nginx/sites-available/wordpress", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/nginx/sites-available/wordpress", "size": 968, "state": "file", "uid": 0}
2022-02-15 11:45:30,649 p=91917 u=pavel n=ansible | TASK [wordpress : Activate activate site] *************************************************************************************************************************************************************
2022-02-15 11:45:30,936 p=91917 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "dest": "/etc/nginx/sites-enabled/wordpress", "gid": 0, "group": "root", "mode": "0777", "owner": "root", "size": 36, "src": "/etc/nginx/sites-available/wordpress", "state": "link", "uid": 0}
2022-02-15 11:45:30,943 p=91917 u=pavel n=ansible | META: ran handlers
2022-02-15 11:45:30,949 p=91917 u=pavel n=ansible | META: ran handlers
2022-02-15 11:45:30,951 p=91917 u=pavel n=ansible | PLAY RECAP ********************************************************************************************************************************************************************************************
2022-02-15 11:45:30,951 p=91917 u=pavel n=ansible | 192.168.88.28              : ok=36   changed=3    unreachable=0    failed=0    skipped=10   rescued=0    ignored=0   
2022-02-15 11:57:09,753 p=100828 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 11:57:09,753 p=100828 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 11:57:14,063 p=100828 u=pavel n=ansible | ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each:
JSON: Expecting value: line 1 column 1 (char 0)

Syntax Error while loading YAML.
  did not find expected '-' indicator

The error appears to be in '/home/pavel/ansible-cm/playbook.yml': line 19, column 1, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


-name: Tests
^ here

2022-02-15 11:57:42,359 p=101037 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 11:57:42,359 p=101037 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 11:57:47,024 p=101037 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:57:47,026 p=101037 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:57:47,027 p=101037 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:57:47,028 p=101037 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:57:47,029 p=101037 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:57:47,040 p=101037 u=pavel n=ansible | statically imported: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/vhosts.yml
2022-02-15 11:57:47,059 p=101037 u=pavel n=ansible | Skipping callback 'default', as we already have a stdout callback.
2022-02-15 11:57:47,059 p=101037 u=pavel n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2022-02-15 11:57:47,059 p=101037 u=pavel n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2022-02-15 11:57:47,060 p=101037 u=pavel n=ansible | PLAYBOOK: playbook.yml ********************************************************************************************************************************************************************************
2022-02-15 11:57:47,060 p=101037 u=pavel n=ansible | 3 plays in playbook.yml
2022-02-15 11:57:47,062 p=101037 u=pavel n=ansible | PLAY [Prepare user] ***********************************************************************************************************************************************************************************
2022-02-15 11:57:47,071 p=101037 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 11:57:48,215 p=101037 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 11:57:48,221 p=101037 u=pavel n=ansible | META: ran handlers
2022-02-15 11:57:48,227 p=101037 u=pavel n=ansible | TASK [user : Create group] ****************************************************************************************************************************************************************************
2022-02-15 11:57:48,591 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 1001, "name": "app", "state": "present", "system": false}
2022-02-15 11:57:48,598 p=101037 u=pavel n=ansible | TASK [user : Create user] *****************************************************************************************************************************************************************************
2022-02-15 11:57:49,075 p=101037 u=pavel n=ansible | changed: [192.168.88.28] => {"append": false, "changed": true, "comment": "", "group": 1001, "home": "/home/app", "move_home": false, "name": "app", "password": "NOT_LOGGING_PASSWORD", "shell": "/bin/bash", "state": "present", "uid": 1001}
2022-02-15 11:57:49,081 p=101037 u=pavel n=ansible | TASK [user : Create directory] ************************************************************************************************************************************************************************
2022-02-15 11:57:49,480 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 1001, "group": "app", "mode": "0755", "owner": "app", "path": "/home/app/test_dir", "size": 4096, "state": "directory", "uid": 1001}
2022-02-15 11:57:49,488 p=101037 u=pavel n=ansible | TASK [user : Copy file to remote host] ****************************************************************************************************************************************************************
2022-02-15 11:57:50,362 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "checksum": "03840deb949d6cf0c0a624fa7eba87fbdbcb7783", "dest": "/home/app/test_dir/test.txt", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/home/app/test_dir/test.txt", "size": 10, "state": "file", "uid": 0}
2022-02-15 11:57:50,369 p=101037 u=pavel n=ansible | TASK [user : Install packages] ************************************************************************************************************************************************************************
2022-02-15 11:57:51,506 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:57:51,512 p=101037 u=pavel n=ansible | META: ran handlers
2022-02-15 11:57:51,518 p=101037 u=pavel n=ansible | META: ran handlers
2022-02-15 11:57:51,521 p=101037 u=pavel n=ansible | PLAY [Add apps] ***************************************************************************************************************************************************************************************
2022-02-15 11:57:51,535 p=101037 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 11:57:52,203 p=101037 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 11:57:52,210 p=101037 u=pavel n=ansible | META: ran handlers
2022-02-15 11:57:52,216 p=101037 u=pavel n=ansible | TASK [mysql : Ensure packages is present using apt] ***************************************************************************************************************************************************
2022-02-15 11:57:53,334 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:57:53,341 p=101037 u=pavel n=ansible | TASK [mysql : Ensure pymysql is present using pip] ****************************************************************************************************************************************************
2022-02-15 11:57:54,794 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "cmd": ["/usr/bin/pip3", "install", "pymysql"], "name": ["pymysql"], "requirements": null, "state": "present", "stderr": "", "stderr_lines": [], "stdout": "Requirement already satisfied: pymysql in /usr/local/lib/python3.8/dist-packages (1.0.2)\n", "stdout_lines": ["Requirement already satisfied: pymysql in /usr/local/lib/python3.8/dist-packages (1.0.2)"], "version": null, "virtualenv": null}
2022-02-15 11:57:54,801 p=101037 u=pavel n=ansible | TASK [mysql : Started mysql] **************************************************************************************************************************************************************************
2022-02-15 11:57:55,403 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "name": "mysql", "state": "started", "status": {"ActiveEnterTimestamp": "Tue 2022-02-15 09:41:04 MSK", "ActiveEnterTimestampMonotonic": "7220241", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "system.slice systemd-journald.socket basic.target -.mount network.target sysinit.target", "AllowIsolate": "no", "AllowedCPUs": "", "AllowedMemoryNodes": "", "AmbientCapabilities": "", "AssertResult": "yes", "AssertTimestamp": "Tue 2022-02-15 09:41:02 MSK", "AssertTimestampMonotonic": "5182068", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "no", "CPUAffinity": "", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanClean": "runtime", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read 0x26 0x27 0x28", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Tue 2022-02-15 09:41:02 MSK", "ConditionTimestampMonotonic": "5182068", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/mysql.service", "ControlPID": "0", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "MySQL Community Server", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveCPUs": "", "EffectiveMemoryNodes": "", "Environment": "MYSQLD_PARENT_PID=1", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "895", "ExecMainStartTimestamp": "Tue 2022-02-15 09:41:02 MSK", "ExecMainStartTimestampMonotonic": "5746144", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/sbin/mysqld ; argv[]=/usr/sbin/mysqld ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/mysqld ; argv[]=/usr/sbin/mysqld ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPre": "{ path=/usr/share/mysql/mysql-systemd-start ; argv[]=/usr/share/mysql/mysql-systemd-start pre ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPreEx": "{ path=/usr/share/mysql/mysql-systemd-start ; argv[]=/usr/share/mysql/mysql-systemd-start pre ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/mysql.service", "GID": "134", "Group": "mysql", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "0", "IOSchedulingPriority": "0", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "mysql.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Tue 2022-02-15 09:41:02 MSK", "InactiveExitTimestampMonotonic": "5184347", "InvocationID": "d6e0889fe69a494d881e49211ed1802d", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "10000", "LimitNOFILESoft": "10000", "LimitNPROC": "15295", "LimitNPROCSoft": "15295", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "15295", "LimitSIGPENDINGSoft": "15295", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "895", "MemoryAccounting": "yes", "MemoryCurrent": "421183488", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "MountFlags": "", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAMask": "", "NUMAPolicy": "n/a", "Names": "mysql.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PIDFile": "/run/mysqld/mysqld.pid", "Perpetual": "no", "PrivateDevices": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target -.mount", "RequiresMountsFor": "/run/mysqld", "Restart": "on-failure", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectory": "mysqld", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardInputData": "", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Tue 2022-02-15 09:41:04 MSK", "StateChangeTimestampMonotonic": "7220241", "StateDirectoryMode": "0755", "StatusErrno": "0", "StatusText": "Server is operational", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "37", "TasksMax": "4588", "TimeoutAbortUSec": "infinity", "TimeoutCleanUSec": "infinity", "TimeoutStartUSec": "infinity", "TimeoutStopUSec": "infinity", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "128", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "mysql", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2022-02-15 11:57:55,410 p=101037 u=pavel n=ansible | TASK [mysql : Set the root password] ******************************************************************************************************************************************************************
2022-02-15 11:57:55,496 p=101658 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:57:55,854 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 11:57:55,861 p=101037 u=pavel n=ansible | TASK [mysql : Remove all anonymous user accounts] *****************************************************************************************************************************************************
2022-02-15 11:57:55,923 p=101690 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:57:56,211 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 11:57:56,218 p=101037 u=pavel n=ansible | TASK [mysql : Remove the MySQL test database] *********************************************************************************************************************************************************
2022-02-15 11:57:56,281 p=101728 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:57:56,645 p=101037 u=pavel n=ansible | [WARNING]: Module did not set no_log for unsafe_login_password

2022-02-15 11:57:56,646 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "db": "test", "db_list": ["test"], "executed_commands": []}
2022-02-15 11:57:56,653 p=101037 u=pavel n=ansible | TASK [mysql : Creates database] ***********************************************************************************************************************************************************************
2022-02-15 11:57:56,715 p=101760 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 11:57:56,963 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "db": "db", "db_list": ["db"], "executed_commands": []}
2022-02-15 11:57:56,970 p=101037 u=pavel n=ansible | TASK [mysql : Create MySQL admin user for database] ***************************************************************************************************************************************************
2022-02-15 11:57:57,031 p=101792 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 11:57:57,311 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"censored": "the output has been hidden due to the fact that 'no_log: true' was specified for this result", "changed": false}
2022-02-15 11:57:57,319 p=101037 u=pavel n=ansible | TASK [mysql : check if DB exists] *********************************************************************************************************************************************************************
2022-02-15 11:57:57,692 p=101037 u=pavel n=ansible | changed: [192.168.88.28] => {"changed": true, "cmd": "mysql --host=localhost --user=user --password=pass -e 'SHOW DATABASES;' | grep -c db", "delta": "0:00:00.009251", "end": "2022-02-15 11:57:57.659243", "failed_when_result": false, "msg": "", "rc": 0, "start": "2022-02-15 11:57:57.649992", "stderr": "mysql: [Warning] Using a password on the command line interface can be insecure.", "stderr_lines": ["mysql: [Warning] Using a password on the command line interface can be insecure."], "stdout": "1", "stdout_lines": ["1"]}
2022-02-15 11:57:57,699 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : Include OS-specific variables.] *********************************************************************************************************************************************
2022-02-15 11:57:57,731 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"ansible_facts": {"__nginx_user": "www-data", "nginx_conf_file_path": "/etc/nginx/nginx.conf", "nginx_conf_path": "/etc/nginx/conf.d", "nginx_default_vhost_path": "/etc/nginx/sites-enabled/default", "nginx_mime_file_path": "/etc/nginx/mime.types", "nginx_pidfile": "/run/nginx.pid", "nginx_vhost_path": "/etc/nginx/sites-enabled", "root_group": "root"}, "ansible_included_var_files": ["/home/pavel/ansible-cm/roles/geerlingguy.nginx/vars/Debian.yml"], "changed": false}
2022-02-15 11:57:57,740 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : Define nginx_user.] *********************************************************************************************************************************************************
2022-02-15 11:57:57,780 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"ansible_facts": {"nginx_user": "www-data"}, "changed": false}
2022-02-15 11:57:57,787 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 11:57:57,824 p=101037 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:57:57,833 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 11:57:57,890 p=101037 u=pavel n=ansible | included: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/setup-Ubuntu.yml for 192.168.88.28
2022-02-15 11:57:57,903 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure dirmngr is installed (gnupg dependency).] ****************************************************************************************************************************
2022-02-15 11:57:58,882 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:57:58,890 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : Add PPA for Nginx (if configured).] *****************************************************************************************************************************************
2022-02-15 11:57:58,926 p=101037 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:57:58,933 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx will reinstall if the PPA was just added.] *********************************************************************************************************************
2022-02-15 11:57:58,966 p=101037 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:57:58,974 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 11:57:59,015 p=101037 u=pavel n=ansible | included: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/setup-Debian.yml for 192.168.88.28
2022-02-15 11:57:59,026 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : Update apt cache.] **********************************************************************************************************************************************************
2022-02-15 11:57:59,741 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:57:59,749 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx is installed.] *************************************************************************************************************************************************
2022-02-15 11:58:00,773 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:58:00,779 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 11:58:00,810 p=101037 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:58:00,817 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 11:58:00,848 p=101037 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:58:00,856 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : include_tasks] **************************************************************************************************************************************************************
2022-02-15 11:58:00,893 p=101037 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:58:00,900 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : Remove default nginx vhost config file (if configured).] ********************************************************************************************************************
2022-02-15 11:58:00,931 p=101037 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "skip_reason": "Conditional result was False"}
2022-02-15 11:58:00,938 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx_vhost_path exists.] ********************************************************************************************************************************************
2022-02-15 11:58:01,213 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/etc/nginx/sites-enabled", "size": 4096, "state": "directory", "uid": 0}
2022-02-15 11:58:01,222 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : Add managed vhost config files.] ********************************************************************************************************************************************
2022-02-15 11:58:01,260 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : Remove managed vhost config files.] *****************************************************************************************************************************************
2022-02-15 11:58:01,297 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : Remove legacy vhosts.conf file.] ********************************************************************************************************************************************
2022-02-15 11:58:01,580 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "path": "/etc/nginx/sites-enabled/vhosts.conf", "state": "absent"}
2022-02-15 11:58:01,588 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : Copy nginx configuration in place.] *****************************************************************************************************************************************
2022-02-15 11:58:02,071 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "checksum": "0b0918e4dfb9031651b7262482e3060fc7667ba5", "dest": "/etc/nginx/nginx.conf", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/nginx/nginx.conf", "size": 883, "state": "file", "uid": 0}
2022-02-15 11:58:02,077 p=101037 u=pavel n=ansible | TASK [geerlingguy.nginx : Ensure nginx service is running as configured.] *****************************************************************************************************************************
2022-02-15 11:58:02,483 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "enabled": true, "name": "nginx", "state": "started", "status": {"ActiveEnterTimestamp": "Tue 2022-02-15 10:23:05 MSK", "ActiveEnterTimestampMonotonic": "2530235319", "ActiveExitTimestamp": "Tue 2022-02-15 09:50:21 MSK", "ActiveExitTimestampMonotonic": "566958399", "ActiveState": "active", "After": "system.slice systemd-journald.socket basic.target network.target sysinit.target", "AllowIsolate": "no", "AllowedCPUs": "", "AllowedMemoryNodes": "", "AmbientCapabilities": "", "AssertResult": "yes", "AssertTimestamp": "Tue 2022-02-15 10:23:05 MSK", "AssertTimestampMonotonic": "2530221105", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "no", "CPUAffinity": "", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read 0x26 0x27 0x28", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Tue 2022-02-15 10:23:05 MSK", "ConditionTimestampMonotonic": "2530221105", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/nginx.service", "ControlPID": "0", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "A high performance web server and a reverse proxy server", "DevicePolicy": "auto", "Documentation": "man:nginx(8)", "DynamicUser": "no", "EffectiveCPUs": "", "EffectiveMemoryNodes": "", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "28442", "ExecMainStartTimestamp": "Tue 2022-02-15 10:23:05 MSK", "ExecMainStartTimestampMonotonic": "2530235301", "ExecMainStatus": "0", "ExecReload": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; ignore_errors=no ; start_time=[Tue 2022-02-15 10:24:13 MSK] ; stop_time=[Tue 2022-02-15 10:24:13 MSK] ; pid=34838 ; code=exited ; status=0 }", "ExecReloadEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; -s reload ; flags= ; start_time=[Tue 2022-02-15 10:24:13 MSK] ; stop_time=[Tue 2022-02-15 10:24:13 MSK] ; pid=34838 ; code=exited ; status=0 }", "ExecStart": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPre": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPreEx": "{ path=/usr/sbin/nginx ; argv[]=/usr/sbin/nginx -t -q -g daemon on; master_process on; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStop": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; ignore_errors=yes ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStopEx": "{ path=/sbin/start-stop-daemon ; argv[]=/sbin/start-stop-daemon --quiet --stop --retry QUIT/5 --pidfile /run/nginx.pid ; flags=ignore-failure ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/nginx.service", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "0", "IOSchedulingPriority": "0", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "nginx.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Tue 2022-02-15 10:21:12 MSK", "InactiveEnterTimestampMonotonic": "2417569318", "InactiveExitTimestamp": "Tue 2022-02-15 10:23:05 MSK", "InactiveExitTimestampMonotonic": "2530223057", "InvocationID": "b65f8dd35c4a4016876e6d5436f981ce", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "65536", "LimitMEMLOCKSoft": "65536", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "15295", "LimitNPROCSoft": "15295", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "15295", "LimitSIGPENDINGSoft": "15295", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "28442", "MemoryAccounting": "yes", "MemoryCurrent": "2875392", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "MountFlags": "", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAMask": "", "NUMAPolicy": "n/a", "Names": "nginx.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PIDFile": "/run/nginx.pid", "Perpetual": "no", "PrivateDevices": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "no", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardInputData": "", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Tue 2022-02-15 10:24:13 MSK", "StateChangeTimestampMonotonic": "2598661082", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "3", "TasksMax": "4588", "TimeoutAbortUSec": "5s", "TimeoutCleanUSec": "infinity", "TimeoutStartUSec": "1min 30s", "TimeoutStopUSec": "5s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "forking", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2022-02-15 11:58:02,490 p=101037 u=pavel n=ansible | TASK [php : Ensure PHP server and plugins is present using apt] ***************************************************************************************************************************************
2022-02-15 11:58:03,497 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"cache_update_time": 1644906353, "cache_updated": false, "changed": false}
2022-02-15 11:58:03,504 p=101037 u=pavel n=ansible | TASK [wordpress : Creates directory] ******************************************************************************************************************************************************************
2022-02-15 11:58:03,750 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 33, "group": "www-data", "mode": "0755", "owner": "www-data", "path": "/var/www/http_host", "size": 4096, "state": "directory", "uid": 33}
2022-02-15 11:58:03,758 p=101037 u=pavel n=ansible | TASK [wordpress : Download and unpack latest WordPress] ***********************************************************************************************************************************************
2022-02-15 11:58:03,872 p=101037 u=pavel n=ansible | skipping: [192.168.88.28] => {"changed": false, "msg": "skipped, since /var/www/http_host/wordpress exists"}
2022-02-15 11:58:03,879 p=101037 u=pavel n=ansible | TASK [wordpress : Set ownership] **********************************************************************************************************************************************************************
2022-02-15 11:58:04,299 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "gid": 33, "group": "www-data", "mode": "0755", "owner": "www-data", "path": "/var/www/http_host", "size": 4096, "state": "directory", "uid": 33}
2022-02-15 11:58:04,305 p=101037 u=pavel n=ansible | TASK [wordpress : Set permissions for directories] ****************************************************************************************************************************************************
2022-02-15 11:58:04,826 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "cmd": "/usr/bin/find /var/www/http_host/wordpress/ -type d -exec chmod 750 {} \\;", "delta": "0:00:00.256928", "end": "2022-02-15 11:58:04.794318", "msg": "", "rc": 0, "start": "2022-02-15 11:58:04.537390", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-02-15 11:58:04,833 p=101037 u=pavel n=ansible | TASK [wordpress : Set permissions for files] **********************************************************************************************************************************************************
2022-02-15 11:58:07,266 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "cmd": "/usr/bin/find /var/www/http_host/wordpress/ -type f -exec chmod 640 {} \\;", "delta": "0:00:02.141192", "end": "2022-02-15 11:58:07.231640", "msg": "", "rc": 0, "start": "2022-02-15 11:58:05.090448", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2022-02-15 11:58:07,273 p=101037 u=pavel n=ansible | TASK [wordpress : Set up wp-config] *******************************************************************************************************************************************************************
2022-02-15 11:58:07,880 p=101037 u=pavel n=ansible | changed: [192.168.88.28] => {"changed": true, "checksum": "4e383be8f409ae8473743c0c2f5e9d2de3d30b88", "dest": "/var/www/http_host/wordpress/wp-config.php", "gid": 33, "group": "www-data", "md5sum": "cd3e863572d2354c12b88011ca2a7344", "mode": "0640", "owner": "www-data", "size": 3131, "src": "/home/pavel/.ansible/tmp/ansible-tmp-1644915487.3161876-105476-133122672299061/source", "state": "file", "uid": 33}
2022-02-15 11:58:07,902 p=101037 u=pavel n=ansible | TASK [wordpress : Add site to sites folder in Nginx] **************************************************************************************************************************************************
2022-02-15 11:58:08,386 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "checksum": "673bd3011f8837e4c1aa3c6dd0052d7db1889327", "dest": "/etc/nginx/sites-available/wordpress", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/nginx/sites-available/wordpress", "size": 968, "state": "file", "uid": 0}
2022-02-15 11:58:08,394 p=101037 u=pavel n=ansible | TASK [wordpress : Activate activate site] *************************************************************************************************************************************************************
2022-02-15 11:58:08,685 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"changed": false, "dest": "/etc/nginx/sites-enabled/wordpress", "gid": 0, "group": "root", "mode": "0777", "owner": "root", "size": 36, "src": "/etc/nginx/sites-available/wordpress", "state": "link", "uid": 0}
2022-02-15 11:58:08,692 p=101037 u=pavel n=ansible | META: ran handlers
2022-02-15 11:58:08,698 p=101037 u=pavel n=ansible | META: ran handlers
2022-02-15 11:58:08,701 p=101037 u=pavel n=ansible | PLAY [Do some tests] **********************************************************************************************************************************************************************************
2022-02-15 11:58:08,710 p=101037 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 11:58:09,386 p=101037 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 11:58:09,392 p=101037 u=pavel n=ansible | META: ran handlers
2022-02-15 11:58:09,398 p=101037 u=pavel n=ansible | TASK [tests : Check URL] ******************************************************************************************************************************************************************************
2022-02-15 11:58:09,859 p=101037 u=pavel n=ansible | ok: [192.168.88.28] => {"accept_ranges": "bytes", "changed": false, "connection": "close", "content_length": "612", "content_type": "text/html", "cookies": {}, "cookies_string": "", "date": "Tue, 15 Feb 2022 08:58:09 GMT", "elapsed": 0, "etag": "\"62011295-264\"", "last_modified": "Mon, 07 Feb 2022 12:37:41 GMT", "msg": "OK (612 bytes)", "redirected": false, "server": "nginx/1.18.0 (Ubuntu)", "status": 200, "url": "http://192.168.88.28"}
2022-02-15 11:58:09,865 p=101037 u=pavel n=ansible | TASK [tests : check if DB exists] *********************************************************************************************************************************************************************
2022-02-15 11:58:09,896 p=101037 u=pavel n=ansible | fatal: [192.168.88.28]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'db_host' is undefined\n\nThe error appears to be in '/home/pavel/ansible-cm/roles/tests/tasks/main.yml': line 9, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: check if DB exists\n  ^ here\n"}
2022-02-15 11:58:09,898 p=101037 u=pavel n=ansible | PLAY RECAP ********************************************************************************************************************************************************************************************
2022-02-15 11:58:09,898 p=101037 u=pavel n=ansible | 192.168.88.28              : ok=37   changed=3    unreachable=0    failed=1    skipped=10   rescued=0    ignored=0   
2022-02-15 12:00:20,015 p=106519 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 12:00:20,015 p=106519 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 12:00:24,049 p=106519 u=pavel n=ansible | ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each:
JSON: Expecting value: line 1 column 1 (char 0)

Syntax Error while loading YAML.
  did not find expected ',' or ']'

The error appears to be in '/home/pavel/ansible-cm/playbook.yml': line 25, column 34, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

  roles:
   - { role: tests, tags: [tests }
                                 ^ here

2022-02-15 12:00:44,566 p=106681 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 12:00:44,566 p=106681 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 12:00:48,698 p=106681 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 12:00:48,700 p=106681 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 12:00:48,701 p=106681 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 12:00:48,702 p=106681 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 12:00:48,703 p=106681 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 12:00:48,712 p=106681 u=pavel n=ansible | statically imported: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/vhosts.yml
2022-02-15 12:00:48,734 p=106681 u=pavel n=ansible | Skipping callback 'default', as we already have a stdout callback.
2022-02-15 12:00:48,734 p=106681 u=pavel n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2022-02-15 12:00:48,734 p=106681 u=pavel n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2022-02-15 12:00:48,734 p=106681 u=pavel n=ansible | PLAYBOOK: playbook.yml ********************************************************************************************************************************************************************************
2022-02-15 12:00:48,735 p=106681 u=pavel n=ansible | 3 plays in playbook.yml
2022-02-15 12:00:48,736 p=106681 u=pavel n=ansible | PLAY [Prepare user] ***********************************************************************************************************************************************************************************
2022-02-15 12:00:48,746 p=106681 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 12:00:49,899 p=106681 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 12:00:49,906 p=106681 u=pavel n=ansible | META: ran handlers
2022-02-15 12:00:49,911 p=106681 u=pavel n=ansible | META: ran handlers
2022-02-15 12:00:49,916 p=106681 u=pavel n=ansible | META: ran handlers
2022-02-15 12:00:49,920 p=106681 u=pavel n=ansible | PLAY [Add apps] ***************************************************************************************************************************************************************************************
2022-02-15 12:00:49,935 p=106681 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 12:00:50,600 p=106681 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 12:00:50,607 p=106681 u=pavel n=ansible | META: ran handlers
2022-02-15 12:00:50,613 p=106681 u=pavel n=ansible | META: ran handlers
2022-02-15 12:00:50,619 p=106681 u=pavel n=ansible | META: ran handlers
2022-02-15 12:00:50,622 p=106681 u=pavel n=ansible | PLAY [Do some tests] **********************************************************************************************************************************************************************************
2022-02-15 12:00:50,634 p=106681 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 12:00:51,311 p=106681 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 12:00:51,317 p=106681 u=pavel n=ansible | META: ran handlers
2022-02-15 12:00:51,324 p=106681 u=pavel n=ansible | TASK [tests : Check URL] ******************************************************************************************************************************************************************************
2022-02-15 12:00:51,785 p=106681 u=pavel n=ansible | ok: [192.168.88.28] => {"accept_ranges": "bytes", "changed": false, "connection": "close", "content_length": "612", "content_type": "text/html", "cookies": {}, "cookies_string": "", "date": "Tue, 15 Feb 2022 09:00:51 GMT", "elapsed": 0, "etag": "\"62011295-264\"", "last_modified": "Mon, 07 Feb 2022 12:37:41 GMT", "msg": "OK (612 bytes)", "redirected": false, "server": "nginx/1.18.0 (Ubuntu)", "status": 200, "url": "http://192.168.88.28"}
2022-02-15 12:00:51,793 p=106681 u=pavel n=ansible | TASK [tests : check if DB exists] *********************************************************************************************************************************************************************
2022-02-15 12:00:51,822 p=106681 u=pavel n=ansible | fatal: [192.168.88.28]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'db_host' is undefined\n\nThe error appears to be in '/home/pavel/ansible-cm/roles/tests/tasks/main.yml': line 9, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: check if DB exists\n  ^ here\n"}
2022-02-15 12:00:51,824 p=106681 u=pavel n=ansible | PLAY RECAP ********************************************************************************************************************************************************************************************
2022-02-15 12:00:51,825 p=106681 u=pavel n=ansible | 192.168.88.28              : ok=4    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2022-02-15 12:02:04,147 p=107494 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 12:02:04,147 p=107494 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 12:02:07,642 p=107494 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 12:02:07,643 p=107494 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 12:02:07,644 p=107494 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 12:02:07,645 p=107494 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 12:02:07,646 p=107494 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 12:02:07,655 p=107494 u=pavel n=ansible | statically imported: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/vhosts.yml
2022-02-15 12:02:07,675 p=107494 u=pavel n=ansible | Skipping callback 'default', as we already have a stdout callback.
2022-02-15 12:02:07,675 p=107494 u=pavel n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2022-02-15 12:02:07,676 p=107494 u=pavel n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2022-02-15 12:02:07,676 p=107494 u=pavel n=ansible | PLAYBOOK: playbook.yml ********************************************************************************************************************************************************************************
2022-02-15 12:02:07,676 p=107494 u=pavel n=ansible | 3 plays in playbook.yml
2022-02-15 12:02:07,678 p=107494 u=pavel n=ansible | PLAY [Prepare user] ***********************************************************************************************************************************************************************************
2022-02-15 12:02:07,687 p=107494 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 12:02:08,846 p=107494 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 12:02:08,853 p=107494 u=pavel n=ansible | META: ran handlers
2022-02-15 12:02:08,859 p=107494 u=pavel n=ansible | META: ran handlers
2022-02-15 12:02:08,866 p=107494 u=pavel n=ansible | META: ran handlers
2022-02-15 12:02:08,870 p=107494 u=pavel n=ansible | PLAY [Add apps] ***************************************************************************************************************************************************************************************
2022-02-15 12:02:08,884 p=107494 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 12:02:09,539 p=107494 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 12:02:09,546 p=107494 u=pavel n=ansible | META: ran handlers
2022-02-15 12:02:09,552 p=107494 u=pavel n=ansible | META: ran handlers
2022-02-15 12:02:09,558 p=107494 u=pavel n=ansible | META: ran handlers
2022-02-15 12:02:09,560 p=107494 u=pavel n=ansible | PLAY [Do some tests] **********************************************************************************************************************************************************************************
2022-02-15 12:02:09,568 p=107494 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 12:02:10,232 p=107494 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 12:02:10,239 p=107494 u=pavel n=ansible | META: ran handlers
2022-02-15 12:02:10,245 p=107494 u=pavel n=ansible | TASK [tests : Check URL] ******************************************************************************************************************************************************************************
2022-02-15 12:02:10,712 p=107494 u=pavel n=ansible | ok: [192.168.88.28] => {"accept_ranges": "bytes", "changed": false, "connection": "close", "content_length": "612", "content_type": "text/html", "cookies": {}, "cookies_string": "", "date": "Tue, 15 Feb 2022 09:02:10 GMT", "elapsed": 0, "etag": "\"62011295-264\"", "last_modified": "Mon, 07 Feb 2022 12:37:41 GMT", "msg": "OK (612 bytes)", "redirected": false, "server": "nginx/1.18.0 (Ubuntu)", "status": 200, "url": "http://192.168.88.28"}
2022-02-15 12:02:10,719 p=107494 u=pavel n=ansible | TASK [tests : check if DB exists] *********************************************************************************************************************************************************************
2022-02-15 12:02:10,749 p=107494 u=pavel n=ansible | fatal: [192.168.88.28]: FAILED! => {"msg": "The task includes an option with an undefined variable. The error was: 'db_host' is undefined\n\nThe error appears to be in '/home/pavel/ansible-cm/roles/tests/tasks/main.yml': line 9, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n- name: check if DB exists\n  ^ here\n"}
2022-02-15 12:02:10,750 p=107494 u=pavel n=ansible | PLAY RECAP ********************************************************************************************************************************************************************************************
2022-02-15 12:02:10,751 p=107494 u=pavel n=ansible | 192.168.88.28              : ok=4    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2022-02-15 12:04:56,405 p=108892 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 12:04:56,405 p=108892 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 12:05:00,364 p=108892 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 12:05:00,366 p=108892 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 12:05:00,366 p=108892 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 12:05:00,367 p=108892 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 12:05:00,368 p=108892 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 12:05:00,378 p=108892 u=pavel n=ansible | statically imported: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/vhosts.yml
2022-02-15 12:05:00,397 p=108892 u=pavel n=ansible | Skipping callback 'default', as we already have a stdout callback.
2022-02-15 12:05:00,398 p=108892 u=pavel n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2022-02-15 12:05:00,398 p=108892 u=pavel n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2022-02-15 12:05:00,398 p=108892 u=pavel n=ansible | PLAYBOOK: playbook.yml ********************************************************************************************************************************************************************************
2022-02-15 12:05:00,398 p=108892 u=pavel n=ansible | 3 plays in playbook.yml
2022-02-15 12:05:00,400 p=108892 u=pavel n=ansible | PLAY [Prepare user] ***********************************************************************************************************************************************************************************
2022-02-15 12:05:00,409 p=108892 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 12:05:01,582 p=108892 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 12:05:01,588 p=108892 u=pavel n=ansible | META: ran handlers
2022-02-15 12:05:01,594 p=108892 u=pavel n=ansible | META: ran handlers
2022-02-15 12:05:01,600 p=108892 u=pavel n=ansible | META: ran handlers
2022-02-15 12:05:01,604 p=108892 u=pavel n=ansible | PLAY [Add apps] ***************************************************************************************************************************************************************************************
2022-02-15 12:05:01,617 p=108892 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 12:05:02,291 p=108892 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 12:05:02,297 p=108892 u=pavel n=ansible | META: ran handlers
2022-02-15 12:05:02,303 p=108892 u=pavel n=ansible | META: ran handlers
2022-02-15 12:05:02,310 p=108892 u=pavel n=ansible | META: ran handlers
2022-02-15 12:05:02,313 p=108892 u=pavel n=ansible | PLAY [Do some tests] **********************************************************************************************************************************************************************************
2022-02-15 12:05:02,321 p=108892 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 12:05:03,988 p=108892 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 12:05:03,994 p=108892 u=pavel n=ansible | META: ran handlers
2022-02-15 12:05:04,000 p=108892 u=pavel n=ansible | TASK [tests : Check URL] ******************************************************************************************************************************************************************************
2022-02-15 12:05:04,451 p=108892 u=pavel n=ansible | ok: [192.168.88.28] => {"accept_ranges": "bytes", "changed": false, "connection": "close", "content_length": "612", "content_type": "text/html", "cookies": {}, "cookies_string": "", "date": "Tue, 15 Feb 2022 09:05:04 GMT", "elapsed": 0, "etag": "\"62011295-264\"", "last_modified": "Mon, 07 Feb 2022 12:37:41 GMT", "msg": "OK (612 bytes)", "redirected": false, "server": "nginx/1.18.0 (Ubuntu)", "status": 200, "url": "http://192.168.88.28"}
2022-02-15 12:05:04,458 p=108892 u=pavel n=ansible | TASK [tests : check if DB exists] *********************************************************************************************************************************************************************
2022-02-15 12:05:04,822 p=108892 u=pavel n=ansible | changed: [192.168.88.28] => {"changed": true, "cmd": "mysql --host=192.168.88.28 --user=user --password=pass -e 'SHOW DATABASES;' | grep -c db", "delta": "0:00:00.014554", "end": "2022-02-15 12:05:04.791554", "failed_when_result": false, "msg": "non-zero return code", "rc": 1, "start": "2022-02-15 12:05:04.777000", "stderr": "mysql: [Warning] Using a password on the command line interface can be insecure.\nERROR 1130 (HY000): Host '192.168.88.28' is not allowed to connect to this MySQL server", "stderr_lines": ["mysql: [Warning] Using a password on the command line interface can be insecure.", "ERROR 1130 (HY000): Host '192.168.88.28' is not allowed to connect to this MySQL server"], "stdout": "0", "stdout_lines": ["0"]}
2022-02-15 12:05:04,829 p=108892 u=pavel n=ansible | META: ran handlers
2022-02-15 12:05:04,835 p=108892 u=pavel n=ansible | META: ran handlers
2022-02-15 12:05:04,836 p=108892 u=pavel n=ansible | PLAY RECAP ********************************************************************************************************************************************************************************************
2022-02-15 12:05:04,836 p=108892 u=pavel n=ansible | 192.168.88.28              : ok=5    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2022-02-15 12:10:32,616 p=111328 u=pavel n=ansible | ERROR! Incorrect options passed
2022-02-15 12:13:05,259 p=112298 u=pavel n=ansible | ansible-playbook 2.10.16
  config file = /home/pavel/ansible-cm/ansible.cfg
  configured module search path = ['/home/pavel/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.8/dist-packages/ansible
  executable location = /usr/local/bin/ansible-playbook
  python version = 3.8.10 (default, Nov 26 2021, 20:14:08) [GCC 9.3.0]
2022-02-15 12:13:05,259 p=112298 u=pavel n=ansible | Using /home/pavel/ansible-cm/ansible.cfg as config file
2022-02-15 12:13:09,464 p=112298 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 12:13:09,466 p=112298 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 12:13:09,467 p=112298 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 12:13:09,468 p=112298 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_db to community.mysql.mysql_db
2022-02-15 12:13:09,469 p=112298 u=pavel n=ansible | redirecting (type: modules) ansible.builtin.mysql_user to community.mysql.mysql_user
2022-02-15 12:13:09,480 p=112298 u=pavel n=ansible | statically imported: /home/pavel/ansible-cm/roles/geerlingguy.nginx/tasks/vhosts.yml
2022-02-15 12:13:09,502 p=112298 u=pavel n=ansible | Skipping callback 'default', as we already have a stdout callback.
2022-02-15 12:13:09,502 p=112298 u=pavel n=ansible | Skipping callback 'minimal', as we already have a stdout callback.
2022-02-15 12:13:09,502 p=112298 u=pavel n=ansible | Skipping callback 'oneline', as we already have a stdout callback.
2022-02-15 12:13:09,502 p=112298 u=pavel n=ansible | PLAYBOOK: playbook.yml ********************************************************************************************************************************************************************************
2022-02-15 12:13:09,503 p=112298 u=pavel n=ansible | 3 plays in playbook.yml
2022-02-15 12:13:09,505 p=112298 u=pavel n=ansible | PLAY [Prepare user] ***********************************************************************************************************************************************************************************
2022-02-15 12:13:09,514 p=112298 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 12:13:10,670 p=112298 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 12:13:10,677 p=112298 u=pavel n=ansible | META: ran handlers
2022-02-15 12:13:10,683 p=112298 u=pavel n=ansible | META: ran handlers
2022-02-15 12:13:10,689 p=112298 u=pavel n=ansible | META: ran handlers
2022-02-15 12:13:10,693 p=112298 u=pavel n=ansible | PLAY [Add apps] ***************************************************************************************************************************************************************************************
2022-02-15 12:13:10,706 p=112298 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 12:13:11,364 p=112298 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 12:13:11,370 p=112298 u=pavel n=ansible | META: ran handlers
2022-02-15 12:13:11,376 p=112298 u=pavel n=ansible | META: ran handlers
2022-02-15 12:13:11,382 p=112298 u=pavel n=ansible | META: ran handlers
2022-02-15 12:13:11,384 p=112298 u=pavel n=ansible | PLAY [Do some tests] **********************************************************************************************************************************************************************************
2022-02-15 12:13:11,391 p=112298 u=pavel n=ansible | TASK [Gathering Facts] ********************************************************************************************************************************************************************************
2022-02-15 12:13:12,050 p=112298 u=pavel n=ansible | ok: [192.168.88.28]
2022-02-15 12:13:12,056 p=112298 u=pavel n=ansible | META: ran handlers
2022-02-15 12:13:12,062 p=112298 u=pavel n=ansible | TASK [tests : Check URL] ******************************************************************************************************************************************************************************
2022-02-15 12:13:12,525 p=112298 u=pavel n=ansible | ok: [192.168.88.28] => {"accept_ranges": "bytes", "changed": false, "connection": "close", "content_length": "612", "content_type": "text/html", "cookies": {}, "cookies_string": "", "date": "Tue, 15 Feb 2022 09:13:12 GMT", "elapsed": 0, "etag": "\"62011295-264\"", "last_modified": "Mon, 07 Feb 2022 12:37:41 GMT", "msg": "OK (612 bytes)", "redirected": false, "server": "nginx/1.18.0 (Ubuntu)", "status": 200, "url": "http://192.168.88.28"}
2022-02-15 12:13:12,532 p=112298 u=pavel n=ansible | TASK [tests : check if DB exists] *********************************************************************************************************************************************************************
2022-02-15 12:13:12,920 p=112298 u=pavel n=ansible | changed: [192.168.88.28] => {"changed": true, "cmd": "mysql --host=192.168.88.28 --user=user --password=pass -e 'SHOW DATABASES;' | grep -c db", "delta": "0:00:00.008370", "end": "2022-02-15 12:13:12.886325", "failed_when_result": false, "msg": "non-zero return code", "rc": 1, "start": "2022-02-15 12:13:12.877955", "stderr": "mysql: [Warning] Using a password on the command line interface can be insecure.\nERROR 1130 (HY000): Host '192.168.88.28' is not allowed to connect to this MySQL server", "stderr_lines": ["mysql: [Warning] Using a password on the command line interface can be insecure.", "ERROR 1130 (HY000): Host '192.168.88.28' is not allowed to connect to this MySQL server"], "stdout": "0", "stdout_lines": ["0"]}
2022-02-15 12:13:12,926 p=112298 u=pavel n=ansible | TASK [tests : Download index.nginx-debian.html] *******************************************************************************************************************************************************
2022-02-15 12:13:13,362 p=112298 u=pavel n=ansible | changed: [192.168.88.28] => {"changed": true, "checksum_dest": null, "checksum_src": "7dd71afcfb14e105e80b0c0d7fce370a28a41f0a", "dest": "/tmp/test.html", "elapsed": 0, "gid": 0, "group": "root", "md5sum": "e3eb0a1df437f3f97a64aca5952c8ea0", "mode": "0440", "msg": "OK (612 bytes)", "owner": "root", "size": 612, "src": "/home/pavel/.ansible/tmp/ansible-tmp-1644916392.9527702-112691-13984915081183/tmpn0b_79on", "state": "file", "status_code": 200, "uid": 0, "url": "http://192.168.88.28/index.nginx-debian.html"}
2022-02-15 12:13:13,369 p=112298 u=pavel n=ansible | META: ran handlers
2022-02-15 12:13:13,375 p=112298 u=pavel n=ansible | META: ran handlers
2022-02-15 12:13:13,376 p=112298 u=pavel n=ansible | PLAY RECAP ********************************************************************************************************************************************************************************************
2022-02-15 12:13:13,376 p=112298 u=pavel n=ansible | 192.168.88.28              : ok=6    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
